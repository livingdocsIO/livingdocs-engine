require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a){return null===a||void 0===a}function e(a){return a&&"object"==typeof a&&"number"==typeof a.length?"function"!=typeof a.copy||"function"!=typeof a.slice?!1:a.length>0&&"number"!=typeof a[0]?!1:!0:!1}function f(a,b,c){var f,k;if(d(a)||d(b))return!1;if(a.prototype!==b.prototype)return!1;if(i(a))return i(b)?(a=g.call(a),b=g.call(b),j(a,b,c)):!1;if(e(a)){if(!e(b))return!1;if(a.length!==b.length)return!1;for(f=0;f<a.length;f++)if(a[f]!==b[f])return!1;return!0}try{var l=h(a),m=h(b)}catch(n){return!1}if(l.length!=m.length)return!1;for(l.sort(),m.sort(),f=l.length-1;f>=0;f--)if(l[f]!=m[f])return!1;for(f=l.length-1;f>=0;f--)if(k=l[f],!j(a[k],b[k],c))return!1;return typeof a==typeof b}var g=Array.prototype.slice,h=a("./lib/keys.js"),i=a("./lib/is_arguments.js"),j=b.exports=function(a,b,c){return c||(c={}),a===b?!0:a instanceof Date&&b instanceof Date?a.getTime()===b.getTime():"object"!=typeof a&&"object"!=typeof b?c.strict?a===b:a==b:f(a,b,c)}},{"./lib/is_arguments.js":2,"./lib/keys.js":3}],2:[function(a,b,c){function d(a){return"[object Arguments]"==Object.prototype.toString.call(a)}function e(a){return a&&"object"==typeof a&&"number"==typeof a.length&&Object.prototype.hasOwnProperty.call(a,"callee")&&!Object.prototype.propertyIsEnumerable.call(a,"callee")||!1}var f="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();c=b.exports=f?d:e,c.supported=d,c.unsupported=e},{}],3:[function(a,b,c){function d(a){var b=[];for(var c in a)b.push(c);return b}c=b.exports="function"==typeof Object.keys?Object.keys:d,c.shim=d},{}],4:[function(a,b,c){var d,e;d=a("./scheme"),e=new d,e["new"]=function(){return new d},b.exports=e,"undefined"!=typeof window&&null!==window&&(window.jScheme=e)},{"./scheme":6}],5:[function(a,b,c){var d;b.exports=d=function(){function a(a){var b;this.inputString=a.inputString,this.scheme=a.scheme,this.property=a.property,this.parent=a.parent,this.validators=[],this.location=this.getLocation(),this.scheme.propertiesRequired&&null!=(b=this.parent)&&b.addRequiredProperty(this.property),this.addValidations(this.inputString)}var b;return b=/\w[\w ]*\w/g,a.prototype.getLocation=function(){return null==this.property?"":null!=this.parent?this.parent.location+this.scheme.writeProperty(this.property):this.scheme.writeProperty(this.property)},a.prototype.getPropLocation=function(a){return""+this.location+this.scheme.writeProperty(a)},a.prototype.addValidations=function(a){for(var c,d,e;c=b.exec(a);)d=c[0],"optional"===d?this.parent.removeRequiredProperty(this.property):"required"===d?this.parent.addRequiredProperty(this.property):0===d.indexOf("array of ")?(this.validators.push("array"),this.arrayValidator=d.slice(9)):-1!==d.indexOf(" or ")?(e=d.split(" or "),console.log("todo")):this.validators.push(d);return void 0},a.prototype.validate=function(a,b){var c,d,e,f,g,h,i,j;if(c=!0,null==a&&this.isOptional())return c;for(g=this.scheme.validators,j=this.validators||[],h=0,i=j.length;i>h;h++){if(d=j[h],f=g[d],null==f)return b.add("missing validator "+d,{location:this.location});e=f(a),e!==!0&&(b.add(e,{location:this.location,defaultMessage:""+d+" validator failed"}),c=!1)}return(c=this.validateArray(a,b))&&(c=this.validateRequiredProperties(a,b))?c:!1},a.prototype.validateArray=function(a,b){var c,d,e,f,g,h,i,j,k;if(null==this.arrayValidator)return!0;if(e=!0,h=this.scheme.validators[this.arrayValidator],null==h)return b.add("missing validator "+this.arrayValidator,{location:this.location});for(k=a||[],d=i=0,j=k.length;j>i;d=++i)c=k[d],g=h(c),g!==!0&&(f=""+this.location+"["+d+"]",b.add(g,{location:f,defaultMessage:""+this.arrayValidator+" validator failed"}),e=!1);return e},a.prototype.validateOtherProperty=function(a,b,c){var d;return null!=this.otherPropertyValidator?(this.scheme.errors=void 0,(d=this.otherPropertyValidator.call(this,a,b))?!0:(null!=this.scheme.errors?c.join(this.scheme.errors,{location:this.getPropLocation(a)}):c.add("additional property check failed",{location:this.getPropLocation(a)}),!1)):this.scheme.allowAdditionalProperties?!0:(c.add("unspecified additional property",{location:this.getPropLocation(a)}),!1)},a.prototype.validateRequiredProperties=function(a,b){var c,d,e,f;d=!0,f=this.requiredProperties;for(e in f)c=f[e],null==a[e]&&c&&(b.add("required property missing",{location:this.getPropLocation(e)}),d=!1);return d},a.prototype.addRequiredProperty=function(a){return null==this.requiredProperties&&(this.requiredProperties={}),this.requiredProperties[a]=!0},a.prototype.removeRequiredProperty=function(a){var b;return null!=(b=this.requiredProperties)?b[a]=void 0:void 0},a.prototype.isOptional=function(){return null!=this.parent?!this.parent.requiredProperties[this.property]==!0:void 0},a}()},{}],6:[function(a,b,c){var d,e,f,g,h;f=a("./validation_errors"),d=a("./property_validator"),h=a("./validators"),g=a("./type"),b.exports=e=function(){function a(){this.validators=Object.create(h),this.schemas={},this.propertiesRequired=!0,this.allowAdditionalProperties=!0}var b;return b=/^[a-zA-Z]\w*$/,a.prototype.configure=function(a){this.propertiesRequired=a.propertiesRequired,this.allowAdditionalProperties=a.allowAdditionalProperties},a.prototype.add=function(a,b){return g.isFunction(b)?this.addValidator(a,b):this.addSchema(a,this.parseConfigObj(b,void 0,a)),this},a.prototype.addSchema=function(a,b){if(null!=this.validators[a])throw new Error("A validator is alredy registered under this name: "+a);return this.schemas[a]=b,this.validators[a]=function(a){return function(c){var d;return d=a.recursiveValidate(b,c),d.hasErrors()?d:!0}}(this),this},a.prototype.addValidator=function(a,b){return this.validators[a]=b,this},a.prototype.validate=function(a,b){var c;return this.errors=void 0,c=this.schemas[a],null==c?(this.errors=new f,this.errors.add("missing schema",{location:a}),!1):(this.errors=this.recursiveValidate(c,b).setRoot(a),!this.errors.hasErrors())},a.prototype.hasErrors=function(){var a;return null!=(a=this.errors)?a.hasErrors():void 0},a.prototype.getErrorMessages=function(){var a;return null!=(a=this.errors)?a.getMessages():void 0},a.prototype.recursiveValidate=function(a,b){var c,d,e,h,i,j;h=a.__validator,c=new f,h.validate(b,c);for(e in b)j=b[e],null!=a[e]?(i=a[e].__validator,d=i.validate(j,c),d&&null==i.childSchemaName&&g.isObject(j)&&c.join(this.recursiveValidate(a[e],j))):h.validateOtherProperty(e,j,c);return c},a.prototype.parseConfigObj=function(a,b){var c,e,f;null==b&&(b=new d({inputString:"object",scheme:this}));for(c in a)f=a[c],this.addParentValidator(b,c,f)||(g.isString(f)?(e=new d({inputString:f,property:c,parent:b,scheme:this}),a[c]={__validator:e}):g.isObject(f)&&(e=new d({inputString:"object",property:c,parent:b,scheme:this}),a[c]=this.parseConfigObj(f,e)));return a.__validator=b,a},a.prototype.addParentValidator=function(a,b,c){switch(b){case"__validate":a.addValidations(c);break;case"__additionalProperty":g.isFunction(c)&&(a.otherPropertyValidator=c);break;default:return!1}return!0},a.prototype.writeProperty=function(a){return b.test(a)?"."+a:"['"+a+"']"},a}()},{"./property_validator":5,"./type":7,"./validation_errors":8,"./validators":9}],7:[function(a,b,c){var d,e;d=Object.prototype.toString,b.exports=e={isObject:function(a){var b;return b=typeof a,"object"===b&&!!a&&!this.isArray(a)},isBoolean:function(a){return a===!0||a===!1||"[object Boolean]"===d.call(a)}},["Function","String","Number","Date","RegExp","Array"].forEach(function(a){return e["is"+a]=function(b){return d.call(b)==="[object "+a+"]"}}),Array.isArray&&(e.isArray=Array.isArray)},{}],8:[function(a,b,c){var d,e;e=a("./type"),b.exports=d=function(){function a(){}return a.prototype.hasErrors=function(){return null!=this.errors},a.prototype.setRoot=function(a){return this.root=a,this},a.prototype.add=function(b,c){var d,f,g,h;if(h=null!=c?c:{},g=h.location,d=h.defaultMessage,b===!1&&(b=d),void 0===b&&(b="validator returned undefined. Check your validator implementation."),null==this.errors&&(this.errors=[]),e.isString(b))this.errors.push({path:g,message:b});else if(b instanceof a)this.join(b,{location:g});else{if(!b.path||!b.message)throw new Error("ValidationError.add() unknown error type");f=b,this.errors.push({path:g+f.path,message:f.message})}return!1},a.prototype.join=function(a,b){var c,d,e,f,g,h;if(d=a.errors,e=(null!=b?b:{}).location,null!=d&&d.length){for(null==this.errors&&(this.errors=[]),h=[],f=0,g=d.length;g>f;f++)c=d[f],h.push(this.errors.push({path:(e||"")+c.path,message:c.message}));return h}},a.prototype.getMessages=function(){var a,b,c,d,e;for(b=[],e=this.errors||[],c=0,d=e.length;d>c;c++)a=e[c],b.push(""+(this.root||"")+a.path+": "+a.message);return b},a}()},{"./type":7}],9:[function(a,b,c){var d;d=a("./type"),b.exports={object:function(a){return d.isObject(a)},string:function(a){return d.isString(a)},"boolean":function(a){return d.isBoolean(a)},number:function(a){return d.isNumber(a)},"function":function(a){return d.isFunction(a)},date:function(a){return d.isDate(a)},regexp:function(a){return d.isRegExp(a)},array:function(a){return d.isArray(a)},falsy:function(a){return!!a==!1},truthy:function(a){return!!a==!0},"not empty":function(a){return!!a==!0},deprecated:function(a){return!0}}},{"./type":7}],10:[function(a,b,c){(function(){var a=this,d=a._,e={},f=Array.prototype,g=Object.prototype,h=Function.prototype,i=f.push,j=f.slice,k=f.concat,l=g.toString,m=g.hasOwnProperty,n=f.forEach,o=f.map,p=f.reduce,q=f.reduceRight,r=f.filter,s=f.every,t=f.some,u=f.indexOf,v=f.lastIndexOf,w=Array.isArray,x=Object.keys,y=h.bind,z=function(a){return a instanceof z?a:this instanceof z?void(this._wrapped=a):new z(a)};"undefined"!=typeof c?("undefined"!=typeof b&&b.exports&&(c=b.exports=z),c._=z):a._=z,z.VERSION="1.6.0";var A=z.each=z.forEach=function(a,b,c){if(null==a)return a;if(n&&a.forEach===n)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,f=a.length;f>d;d++)if(b.call(c,a[d],d,a)===e)return}else for(var g=z.keys(a),d=0,f=g.length;f>d;d++)if(b.call(c,a[g[d]],g[d],a)===e)return;return a};z.map=z.collect=function(a,b,c){var d=[];return null==a?d:o&&a.map===o?a.map(b,c):(A(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var B="Reduce of empty array with no initial value";z.reduce=z.foldl=z.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),p&&a.reduce===p)return d&&(b=z.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(A(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(B);return c},z.reduceRight=z.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),q&&a.reduceRight===q)return d&&(b=z.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=z.keys(a);f=g.length}if(A(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(B);return c},z.find=z.detect=function(a,b,c){var d;return C(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},z.filter=z.select=function(a,b,c){var d=[];return null==a?d:r&&a.filter===r?a.filter(b,c):(A(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},z.reject=function(a,b,c){return z.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},z.every=z.all=function(a,b,c){b||(b=z.identity);var d=!0;return null==a?d:s&&a.every===s?a.every(b,c):(A(a,function(a,f,g){return(d=d&&b.call(c,a,f,g))?void 0:e}),!!d)};var C=z.some=z.any=function(a,b,c){b||(b=z.identity);var d=!1;return null==a?d:t&&a.some===t?a.some(b,c):(A(a,function(a,f,g){return d||(d=b.call(c,a,f,g))?e:void 0}),!!d)};z.contains=z.include=function(a,b){return null==a?!1:u&&a.indexOf===u?-1!=a.indexOf(b):C(a,function(a){return a===b})},z.invoke=function(a,b){var c=j.call(arguments,2),d=z.isFunction(b);return z.map(a,function(a){return(d?b:a[b]).apply(a,c)})},z.pluck=function(a,b){return z.map(a,z.property(b))},z.where=function(a,b){return z.filter(a,z.matches(b))},z.findWhere=function(a,b){return z.find(a,z.matches(b))},z.max=function(a,b,c){if(!b&&z.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);var d=-(1/0),e=-(1/0);return A(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;h>e&&(d=a,e=h)}),d},z.min=function(a,b,c){if(!b&&z.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);var d=1/0,e=1/0;return A(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;e>h&&(d=a,e=h)}),d},z.shuffle=function(a){var b,c=0,d=[];return A(a,function(a){b=z.random(c++),d[c-1]=d[b],d[b]=a}),d},z.sample=function(a,b,c){return null==b||c?(a.length!==+a.length&&(a=z.values(a)),a[z.random(a.length-1)]):z.shuffle(a).slice(0,Math.max(0,b))};var D=function(a){return null==a?z.identity:z.isFunction(a)?a:z.property(a)};z.sortBy=function(a,b,c){return b=D(b),z.pluck(z.map(a,function(a,d,e){return{value:a,index:d,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var E=function(a){return function(b,c,d){var e={};return c=D(c),A(b,function(f,g){var h=c.call(d,f,g,b);a(e,h,f)}),e}};z.groupBy=E(function(a,b,c){z.has(a,b)?a[b].push(c):a[b]=[c]}),z.indexBy=E(function(a,b,c){a[b]=c}),z.countBy=E(function(a,b){z.has(a,b)?a[b]++:a[b]=1}),z.sortedIndex=function(a,b,c,d){c=D(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},z.toArray=function(a){return a?z.isArray(a)?j.call(a):a.length===+a.length?z.map(a,z.identity):z.values(a):[]},z.size=function(a){return null==a?0:a.length===+a.length?a.length:z.keys(a).length},z.first=z.head=z.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:0>b?[]:j.call(a,0,b)},z.initial=function(a,b,c){return j.call(a,0,a.length-(null==b||c?1:b))},z.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:j.call(a,Math.max(a.length-b,0))},z.rest=z.tail=z.drop=function(a,b,c){return j.call(a,null==b||c?1:b)},z.compact=function(a){return z.filter(a,z.identity)};var F=function(a,b,c){return b&&z.every(a,z.isArray)?k.apply(c,a):(A(a,function(a){z.isArray(a)||z.isArguments(a)?b?i.apply(c,a):F(a,b,c):c.push(a)}),c)};z.flatten=function(a,b){return F(a,b,[])},z.without=function(a){return z.difference(a,j.call(arguments,1))},z.partition=function(a,b){var c=[],d=[];return A(a,function(a){(b(a)?c:d).push(a)}),[c,d]},z.uniq=z.unique=function(a,b,c,d){z.isFunction(b)&&(d=c,c=b,b=!1);var e=c?z.map(a,c,d):a,f=[],g=[];return A(e,function(c,d){(b?d&&g[g.length-1]===c:z.contains(g,c))||(g.push(c),f.push(a[d]))}),f},z.union=function(){return z.uniq(z.flatten(arguments,!0))},z.intersection=function(a){var b=j.call(arguments,1);return z.filter(z.uniq(a),function(a){return z.every(b,function(b){return z.contains(b,a)})})},z.difference=function(a){var b=k.apply(f,j.call(arguments,1));return z.filter(a,function(a){return!z.contains(b,a)})},z.zip=function(){for(var a=z.max(z.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=z.pluck(arguments,""+c);return b},z.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},z.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=z.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(u&&a.indexOf===u)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},z.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(v&&a.lastIndexOf===v)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},z.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var G=function(){};z.bind=function(a,b){var c,d;if(y&&a.bind===y)return y.apply(a,j.call(arguments,1));if(!z.isFunction(a))throw new TypeError;return c=j.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(j.call(arguments)));G.prototype=a.prototype;var e=new G;G.prototype=null;var f=a.apply(e,c.concat(j.call(arguments)));return Object(f)===f?f:e}},z.partial=function(a){var b=j.call(arguments,1);return function(){for(var c=0,d=b.slice(),e=0,f=d.length;f>e;e++)d[e]===z&&(d[e]=arguments[c++]);for(;c<arguments.length;)d.push(arguments[c++]);return a.apply(this,d)}},z.bindAll=function(a){var b=j.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return A(b,function(b){a[b]=z.bind(a[b],a)}),a},z.memoize=function(a,b){var c={};return b||(b=z.identity),function(){var d=b.apply(this,arguments);return z.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},z.delay=function(a,b){var c=j.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},z.defer=function(a){return z.delay.apply(z,[a,1].concat(j.call(arguments,1)))},z.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:z.now(),g=null,f=a.apply(d,e),d=e=null};return function(){var j=z.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),d=e=null):g||c.trailing===!1||(g=setTimeout(i,k)),f}},z.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=z.now()-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),f=e=null))};return function(){f=this,e=arguments,g=z.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},z.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},z.wrap=function(a,b){return z.partial(b,a)},z.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},z.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},z.keys=function(a){if(!z.isObject(a))return[];if(x)return x(a);var b=[];for(var c in a)z.has(a,c)&&b.push(c);return b},z.values=function(a){for(var b=z.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},z.pairs=function(a){for(var b=z.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},z.invert=function(a){for(var b={},c=z.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},z.functions=z.methods=function(a){var b=[];for(var c in a)z.isFunction(a[c])&&b.push(c);return b.sort()},z.extend=function(a){return A(j.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},z.pick=function(a){var b={},c=k.apply(f,j.call(arguments,1));return A(c,function(c){c in a&&(b[c]=a[c])}),b},z.omit=function(a){var b={},c=k.apply(f,j.call(arguments,1));for(var d in a)z.contains(c,d)||(b[d]=a[d]);return b},z.defaults=function(a){return A(j.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},z.clone=function(a){return z.isObject(a)?z.isArray(a)?a.slice():z.extend({},a):a},z.tap=function(a,b){return b(a),a};var H=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof z&&(a=a._wrapped),b instanceof z&&(b=b._wrapped);var e=l.call(a);if(e!=l.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(z.isFunction(g)&&g instanceof g&&z.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1;c.push(a),d.push(b);var i=0,j=!0;if("[object Array]"==e){if(i=a.length,j=i==b.length)for(;i--&&(j=H(a[i],b[i],c,d)););}else{for(var k in a)if(z.has(a,k)&&(i++,!(j=z.has(b,k)&&H(a[k],b[k],c,d))))break;if(j){for(k in b)if(z.has(b,k)&&!i--)break;j=!i}}return c.pop(),d.pop(),j};z.isEqual=function(a,b){return H(a,b,[],[])},z.isEmpty=function(a){if(null==a)return!0;if(z.isArray(a)||z.isString(a))return 0===a.length;for(var b in a)if(z.has(a,b))return!1;return!0},z.isElement=function(a){return!(!a||1!==a.nodeType)},z.isArray=w||function(a){return"[object Array]"==l.call(a)},z.isObject=function(a){return a===Object(a)},A(["Arguments","Function","String","Number","Date","RegExp"],function(a){z["is"+a]=function(b){return l.call(b)=="[object "+a+"]"}}),z.isArguments(arguments)||(z.isArguments=function(a){return!(!a||!z.has(a,"callee"))}),"function"!=typeof/./&&(z.isFunction=function(a){return"function"==typeof a}),z.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},z.isNaN=function(a){return z.isNumber(a)&&a!=+a},z.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==l.call(a)},z.isNull=function(a){return null===a},z.isUndefined=function(a){return void 0===a},z.has=function(a,b){return m.call(a,b)},z.noConflict=function(){return a._=d,this},z.identity=function(a){return a},z.constant=function(a){return function(){return a}},z.property=function(a){return function(b){return b[a]}},z.matches=function(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}},z.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},z.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},z.now=Date.now||function(){return(new Date).getTime()};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};I.unescape=z.invert(I.escape);var J={escape:new RegExp("["+z.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+z.keys(I.unescape).join("|")+")","g")};z.each(["escape","unescape"],function(a){z[a]=function(b){return null==b?"":(""+b).replace(J[a],function(b){return I[a][b]})}}),z.result=function(a,b){if(null==a)return void 0;var c=a[b];return z.isFunction(c)?c.call(a):c},z.mixin=function(a){A(z.functions(a),function(b){var c=z[b]=a[b];z.prototype[b]=function(){var a=[this._wrapped];return i.apply(a,arguments),O.call(this,c.apply(z,a))}})};var K=0;z.uniqueId=function(a){var b=++K+"";return a?a+b:b},z.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;z.template=function(a,b,c){var d;c=z.defaults({},c,z.templateSettings);var e=new RegExp([(c.escape||L).source,(c.interpolate||L).source,(c.evaluate||L).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(N,function(a){return"\\"+M[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,z);var i=function(a){return d.call(this,a,z)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},z.chain=function(a){return z(a).chain()};var O=function(a){return this._chain?z(a).chain():a};z.mixin(z),A(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=f[a];z.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],O.call(this,c)}}),A(["concat","join","slice"],function(a){var b=f[a];z.prototype[a]=function(){return O.call(this,b.apply(this._wrapped,arguments))}}),z.extend(z.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return z})}).call(this)},{}],11:[function(a,b,c){(function(){"use strict";function a(){}function c(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function d(a){return function(){return this[a].apply(this,arguments)}}var e=a.prototype,f=this,g=f.EventEmitter;e.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},e.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},e.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},e.addListener=function(a,b){var d,e=this.getListenersAsObject(a),f="object"==typeof b;for(d in e)e.hasOwnProperty(d)&&-1===c(e[d],b)&&e[d].push(f?b:{listener:b,once:!1});return this},e.on=d("addListener"),e.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},e.once=d("addOnceListener"),e.defineEvent=function(a){return this.getListeners(a),this},e.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},e.removeListener=function(a,b){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=c(f[e],b),-1!==d&&f[e].splice(d,1));return this},e.off=d("removeListener"),e.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},e.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},e.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},e.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},e.removeAllListeners=d("removeEvent"),e.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},e.trigger=d("emitEvent"),e.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},e.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},e._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},e._getEvents=function(){return this._events||(this._events={})},a.noConflict=function(){return f.EventEmitter=g,a},"function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof b&&b.exports?b.exports=a:f.EventEmitter=a}).call(this)},{}],12:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n;j=a("./configuration/config"),i=a("./configuration/augment_config"),h=a("./livingdoc"),d=a("./component_tree/component_tree"),k=a("./design/design_cache"),f=a("./rendering_container/editor_page"),g=a("./rendering_container/js_loader"),e=a("./rendering_container/css_loader"),n=a("../version"),m=a("./image_services/image_service"),b.exports=l=function(){var a;return a=new f,{version:n.version,revision:n.revision,design:k,Livingdoc:h,ComponentTree:d,createLivingdoc:function(a){var b,c,d,e;return c=a.data,d=a.design,e=a.layout,b=a.componentTree,h.create({data:c,designName:d,layoutName:e,componentTree:b})},"new":function(){return this.createLivingdoc.apply(this,arguments)},create:function(){return this.createLivingdoc.apply(this,arguments)},startDrag:$.proxy(a,"startDrag"),config:function(a){return $.extend(!0,j,a),i(j)},JsLoader:g,CssLoader:e,getImageService:function(a){return m.get(a)}}}(),window.doc=l},{"../version":74,"./component_tree/component_tree":19,"./configuration/augment_config":25,"./configuration/config":26,"./design/design_cache":30,"./image_services/image_service":36,"./livingdoc":44,"./rendering_container/css_loader":62,"./rendering_container/editor_page":63,"./rendering_container/js_loader":65}],13:[function(a,b,c){var d;b.exports=d=function(){function a(a){this.components=a,null==this.components&&(this.components=[]),this.createPseudoArray()}return a.prototype.createPseudoArray=function(){var a,b,c,d,e;for(d=this.components,b=a=0,c=d.length;c>a;b=++a)e=d[b],this[b]=e;return this.length=this.components.length,this.components.length?(this.first=this[0],this.last=this[this.components.length-1]):void 0},a.prototype.each=function(a){var b,c,d,e;for(e=this.components,c=0,d=e.length;d>c;c++)b=e[c],a(b);return this},a.prototype.remove=function(){return this.each(function(a){return a.remove()}),this},a}()},{}],14:[function(a,b,c){var d,e;e=a("../modules/logging/assert"),b.exports=d=function(){function a(a){var b,c;this.parentComponent=a.parentComponent,this.name=a.name,c=a.isRoot,b=a.config,this.isRoot=null!=c,this.first=this.last=void 0,this.allowedChildren=void 0,this.parseConfig(b)}return a.prototype.parseConfig=function(a){var b,c,d,e,f;if(null!=a){for(e=a.allowedChildren||[],f=[],c=0,d=e.length;d>c;c++)b=e[c],null==this.allowedChildren&&(this.allowedChildren={}),f.push(this.allowedChildren[b]=!0);return f}},a.prototype.isAllowedAsChild=function(a){return!!(this.canBeNested(a)&&this.isChildAllowed(a)&&this.isAllowedAsParent(a))},a.prototype.canBeNested=function(a){var b;for(b=this.parentComponent;null!=b;){if(b.id===a.id)return!1;b=b.getParent()}return!0},a.prototype.isChildAllowed=function(a){return void 0===this.allowedChildren||this.allowedChildren[a.componentName]},a.prototype.isAllowedAsParent=function(a){var b,c,d,e,f,g;if(!(c=a.template.allowedParents))return!0;for(f=this.isRoot?"root":null!=(g=this.parentComponent)?g.componentName:void 0,d=0,e=c.length;e>d;d++)if(b=c[d],f===b)return!0;return!1},a.prototype.getComponentTree=function(){var a;return this.componentTree||(null!=(a=this.parentComponent)?a.componentTree:void 0)},a.prototype.prepend=function(a){return this.first?this.insertBefore(this.first,a):this.attachComponent(a),this},a.prototype.append=function(a){return this.parentComponent&&e(a!==this.parentComponent,"cannot append component to itself"),this.last?this.insertAfter(this.last,a):this.attachComponent(a),this},a.prototype.insertBefore=function(a,b){var c;if(a.previous!==b)return e(a!==b,"cannot insert component before itself"),c={previous:a.previous,next:a,parentContainer:a.parentContainer},this.attachComponent(b,c)},a.prototype.insertAfter=function(a,b){var c;if(a.next!==b)return e(a!==b,"cannot insert component after itself"),c={previous:a,next:a.next,parentContainer:a.parentContainer},this.attachComponent(b,c)},a.prototype.up=function(a){return null!=a.previous?this.insertBefore(a.previous,a):void 0},a.prototype.down=function(a){return null!=a.next?this.insertAfter(a.next,a):void 0},a.prototype.remove=function(a){return a.destroy(),this._detachComponent(a)},a.prototype.each=function(a){var b,c;for(b=this.first,c=[];b;)b.descendantsAndSelf(a),c.push(b=b.next);return c},a.prototype.eachContainer=function(a){return a(this),this.each(function(b){var c,d,e,f;e=b.containers,f=[];for(d in e)c=e[d],f.push(a(c));return f})},a.prototype.all=function(a){return a(this),this.each(function(b){var c,d,e,f;a(b),e=b.containers,f=[];for(d in e)c=e[d],f.push(a(c));return f})},a.prototype.attachComponent=function(a,b){var c,d;return null==b&&(b={}),e(this.isAllowedAsChild(a),"Component '"+a.componentName+"' is not allowed as a child of "+this.getContainerIdentifier()),d=function(c){return function(){return c.link(a,b)}}(this),(c=this.getComponentTree())?c.attachingComponent(a,d):d()},a.prototype._detachComponent=function(a){var b,c;return c=function(b){return function(){return b.unlink(a)}}(this),(b=this.getComponentTree())?b.detachingComponent(a,c):c()},a.prototype.link=function(a,b){return a.parentContainer&&this.unlink(a),
b.parentContainer||(b.parentContainer=this),this.setComponentPosition(a,b)},a.prototype.unlink=function(a){var b,c,d;return b=a.parentContainer,b?(null==a.previous&&(b.first=a.next),null==a.next&&(b.last=a.previous),null!=(c=a.next)&&(c.previous=a.previous),null!=(d=a.previous)&&(d.next=a.next),this.setComponentPosition(a,{})):void 0},a.prototype.setComponentPosition=function(a,b){var c,d,e;return d=b.parentContainer,e=b.previous,c=b.next,a.parentContainer=d,a.previous=e,a.next=c,d&&(e&&(e.next=a),c&&(c.previous=a),null==a.previous&&(d.first=a),null==a.next)?d.last=a:void 0},a.prototype.getContainerIdentifier=function(){return this.isRoot?"root":this.parentComponent.componentName+".containers['"+this.name+"']"},a}()},{"../modules/logging/assert":49}],15:[function(a,b,c){var d;b.exports=d=function(){function a(a){this.component=a.component,this.templateDirective=a.templateDirective,this.name=this.templateDirective.name,this.type=this.templateDirective.type}return a.prototype.getContent=function(){return this.component.content[this.name]},a.prototype.setContent=function(a){return this.component.setContent(this.name,a)},a.prototype.isEmpty=function(){return!this.getContent()},a.prototype.setData=function(a,b){var c,d;return c="_"+this.name+"Directive",d=this.component.getData(c),null==d&&(d={}),d[a]=b,this.component.setData(c,d)},a.prototype.getData=function(a){var b;return a?null!=(b=this.component.dataValues["_"+this.name+"Directive"])?b[a]:void 0:this.component.dataValues["_"+this.name+"Directive"]},a.prototype.setTmp=function(a,b){return this.tmp={},this.tmp[a]=b},a.prototype.getTmp=function(a){var b;return null!=(b=this.tmp)?b[a]:void 0},a}()},{}],16:[function(a,b,c){var d,e,f,g,h,i;h=a("../modules/logging/assert"),i=a("../image_services/image_service"),d=a("./editable_directive"),f=a("./image_directive"),e=a("./html_directive"),g=a("./link_directive"),b.exports={create:function(a){var b,c,d;return c=a.component,d=a.templateDirective,new(b=this.getDirectiveConstructor(d.type))({component:c,templateDirective:d})},getDirectiveConstructor:function(a){switch(a){case"editable":return d;case"image":return f;case"html":return e;case"link":return g;default:return h(!1,"Unsupported component directive: "+a)}}}},{"../image_services/image_service":36,"../modules/logging/assert":49,"./editable_directive":20,"./html_directive":22,"./image_directive":23,"./link_directive":24}],17:[function(a,b,c){var d,e,f,g,h,i,j,k,l;i=a("deep-equal"),h=a("../configuration/config"),d=a("./component_container"),k=a("../modules/guid"),l=a("../modules/logging/log"),g=a("../modules/logging/assert"),j=a("./component_directive_factory"),f=a("../template/directive_collection"),b.exports=e=function(){function a(a){var b,c;c=null!=a?a:{},this.template=c.template,b=c.id,g(this.template,"cannot instantiate component without template reference"),this.initializeDirectives(),this.styles={},this.dataValues={},this.id=b||k.next(),this.componentName=this.template.name,this.next=void 0,this.previous=void 0,this.componentTree=void 0}return a.prototype.initializeDirectives=function(){var a,b,c,e,g;for(this.directives=new f,e=this.template.directives,g=[],b=0,c=e.length;c>b;b++)switch(a=e[b],a.type){case"container":this.containers||(this.containers={}),g.push(this.containers[a.name]=new d({name:a.name,parentComponent:this,config:a.config}));break;case"editable":case"image":case"html":case"link":this.createComponentDirective(a),this.content||(this.content={}),g.push(this.content[a.name]=void 0);break;default:g.push(l.error("Template directive type '"+a.type+"' not implemented in ComponentModel"))}return g},a.prototype.createComponentDirective=function(a){return this.directives.add(j.create({component:this,templateDirective:a}))},a.prototype.createView=function(a){return this.template.createView(this,a)},a.prototype.getMainView=function(){return this.componentTree.getMainComponentView(this.id)},a.prototype.isAllowedAsSibling=function(a){return this.parentContainer.isAllowedAsChild(a)},a.prototype.isAllowedAsChild=function(a,b){return this.containers[a].isAllowedAsChild(b)},a.prototype.before=function(a){return a?(this.parentContainer.insertBefore(this,a),this):this.previous},a.prototype.after=function(a){return a?(this.parentContainer.insertAfter(this,a),this):this.next},a.prototype.append=function(a,b){return this.containers[a].append(b),this},a.prototype.prepend=function(a,b){return this.containers[a].prepend(b),this},a.prototype.up=function(){return this.parentContainer.up(this),this},a.prototype.down=function(){return this.parentContainer.down(this),this},a.prototype.remove=function(){return this.parentContainer.remove(this)},a.prototype.getParent=function(){var a;return null!=(a=this.parentContainer)?a.parentComponent:void 0},a.prototype.parents=function(a){var b,c;for(b=this,c=[];b=b.getParent();)c.push(a(b));return c},a.prototype.children=function(a){var b,c,d,e,f;e=this.containers,f=[];for(d in e)b=e[d],c=b.first,f.push(function(){var b;for(b=[];c;)a(c),b.push(c=c.next);return b}());return f},a.prototype.childrenAndSelf=function(a){return a(this),this.children(a)},a.prototype.descendants=function(a){var b,c,d,e,f;e=this.containers,f=[];for(d in e)b=e[d],c=b.first,f.push(function(){var b;for(b=[];c;)a(c),c.descendants(a),b.push(c=c.next);return b}());return f},a.prototype.descendantsAndSelf=function(a){return a(this),this.descendants(a)},a.prototype.parentContainers=function(a){var b,c;for(b=this,c=[];null!=b;)a(b.parentContainer),c.push(b=b.getParent());return c},a.prototype.descendantContainers=function(a){return this.descendantsAndSelf(function(b){var c,d,e,f;e=b.containers,f=[];for(d in e)c=e[d],f.push(a(c));return f})},a.prototype.allDescendants=function(a){return this.descendantsAndSelf(function(b){return function(c){var d,e,f,g;c!==b&&a(c),f=c.containers,g=[];for(e in f)d=f[e],g.push(a(d));return g}}(this))},a.prototype.hasContainers=function(){return null!=this.containers},a.prototype.hasEditables=function(){return this.directives.count("editable")>0},a.prototype.hasHtml=function(){return this.directives.count("html")>0},a.prototype.hasImages=function(){return this.directives.count("image")>0},a.prototype.hasLinks=function(){return this.directives.count("link")>0},a.prototype.setContent=function(a,b){if(b){if("string"==typeof b){if(this.content[a]!==b&&(this.content[a]=b,this.componentTree))return this.componentTree.contentChanging(this,a)}else if(!i(this.content[a],b)&&(this.content[a]=b,this.componentTree))return this.componentTree.contentChanging(this,a)}else if(this.content[a]&&(this.content[a]=void 0,this.componentTree))return this.componentTree.contentChanging(this,a)},a.prototype.set=function(a,b){var c,d;return g(null!=(d=this.content)?d.hasOwnProperty(a):void 0,"set error: "+this.componentName+" has no content named "+a),c=this.directives.get(a),c.isImage?c.getImageUrl()!==b&&(c.setImageUrl(b),this.componentTree)?this.componentTree.contentChanging(this,a):void 0:this.setContent(a,b)},a.prototype.get=function(a){var b;return g(null!=(b=this.content)?b.hasOwnProperty(a):void 0,"get error: "+this.componentName+" has no content named "+a),this.directives.get(a).getContent()},a.prototype.isEmpty=function(a){var b;return b=this.get(a),void 0===b||""===b},a.prototype.data=function(a){var b,c,d,e;if("object"!=typeof a)return a?this.dataValues[a]:this.dataValues;b=[];for(c in a)e=a[c],this.changeData(c,e)&&b.push(c);return b.length>0&&null!=(d=this.componentTree)?d.dataChanging(this,b):void 0},a.prototype.setData=function(a,b){var c;return a&&this.changeData(a,b)&&null!=(c=this.componentTree)?c.dataChanging(this,[a]):void 0},a.prototype.getData=function(a){return a?this.dataValues[a]:this.dataValues},a.prototype.changeData=function(a,b){return i(this.dataValues[a],b)?!1:(this.dataValues[a]=b,!0)},a.prototype.getPluginName=function(){var a;return null!=(a=this.plugin)?a.name:void 0},a.prototype.setPlugin=function(a){return this.plugin=a},a.prototype.getPlugin=function(a){return this.plugin},a.prototype.getStyle=function(a){return this.styles[a]},a.prototype.setStyle=function(a,b){var c;return c=this.template.styles[a],c?c.validateValue(b)?this.styles[a]!==b&&(this.styles[a]=b,this.componentTree)?this.componentTree.htmlChanging(this,"style",{name:a,value:b}):void 0:l.warn("Invalid value '"+b+"' for style '"+a+"' in ComponentModel "+this.componentName):l.warn("Unknown style '"+a+"' in ComponentModel "+this.componentName)},a.prototype.style=function(a,b){return console.log("ComponentModel#style() is deprecated. Please use #getStyle() and #setStyle()."),1===arguments.length?this.styles[a]:this.setStyle(a,b)},a.prototype.copy=function(){return l.warn("ComponentModel#copy() is not implemented yet.")},a.prototype.copyWithoutContent=function(){return this.template.createModel()},a.prototype.destroy=function(){},a}()},{"../configuration/config":26,"../modules/guid":48,"../modules/logging/assert":49,"../modules/logging/log":50,"../template/directive_collection":69,"./component_container":14,"./component_directive_factory":16,"deep-equal":1}],18:[function(a,b,c){var d,e,f,g,h,i,j,k;d=a("jquery"),h=a("deep-equal"),g=a("../configuration/config"),i=a("../modules/guid"),j=a("../modules/logging/log"),f=a("../modules/logging/assert"),e=a("./component_model"),k=a("../modules/serialization"),b.exports=function(){return e.prototype.toJson=function(a){var b,c;null==a&&(a=this),b={id:a.id,identifier:a.template.identifier},k.isEmpty(a.content)||(b.content=k.flatCopy(a.content)),k.isEmpty(a.styles)||(b.styles=k.flatCopy(a.styles)),k.isEmpty(a.dataValues)||(b.data=d.extend(!0,{},a.dataValues));for(c in a.containers)b.containers||(b.containers={}),b.containers[c]=[];return b},{fromJson:function(a,b){var c,g,h,i,j,k,l,m,n,o,p,q,r;q=b.get(a.component||a.identifier),f(q,"error while deserializing component: unknown template identifier '"+a.identifier+"'"),k=new e({template:q,id:a.id}),m=a.content;for(l in m)r=m[l],f(k.content.hasOwnProperty(l),"error while deserializing component "+k.componentName+": unknown content '"+l+"'"),k.content[l]="image"===k.directives.get(l).type&&"string"==typeof r?{url:r}:r;n=a.styles;for(p in n)r=n[p],k.setStyle(p,r);a.data&&k.data(a.data),o=a.containers;for(h in o)if(g=o[h],f(k.containers.hasOwnProperty(h),"error while deserializing component: unknown container "+h),g)for(f(d.isArray(g),"error while deserializing component: container is not array "+h),i=0,j=g.length;j>i;i++)c=g[i],k.append(h,this.fromJson(c,b));return k}}}()},{"../configuration/config":26,"../modules/guid":48,"../modules/logging/assert":49,"../modules/logging/log":50,"../modules/serialization":53,"./component_model":17,"deep-equal":1,jquery:"jquery"}],19:[function(a,b,c){var d,e,f,g,h,i,j,k=[].slice;d=a("jquery"),i=a("../modules/logging/assert"),f=a("./component_container"),e=a("./component_array"),g=a("./component_model"),j=a("./component_model_serializer"),b.exports=h=function(){function a(a){var b,c;c=null!=a?a:{},b=c.content,this.design=c.design,i(null!=this.design,"Error instantiating ComponentTree: design param is misssing."),this.componentById={},this.root=new f({isRoot:!0}),null!=b&&this.fromJson(b,this.design),this.root.componentTree=this,this.initializeEvents()}return a.prototype.prepend=function(a){return a=this.getComponent(a),null!=a&&this.root.prepend(a),this},a.prototype.append=function(a){return a=this.getComponent(a),null!=a&&this.root.append(a),this},a.prototype.getComponent=function(a){return"string"==typeof a?this.createComponent(a):a},a.prototype.createComponent=function(a){var b;return b=this.getTemplate(a),b?b.createModel():void 0},a.prototype.getTemplate=function(a){var b;return b=this.design.get(a),i(b,"Could not find template "+a),b},a.prototype.initializeEvents=function(){return this.componentAdded=d.Callbacks(),this.componentRemoved=d.Callbacks(),this.componentMoved=d.Callbacks(),this.componentContentChanged=d.Callbacks(),this.componentHtmlChanged=d.Callbacks(),this.componentSettingsChanged=d.Callbacks(),this.componentDataChanged=d.Callbacks(),this.changed=d.Callbacks()},a.prototype.each=function(a){return this.root.each(a)},a.prototype.eachContainer=function(a){return this.root.eachContainer(a)},a.prototype.first=function(){return this.root.first},a.prototype.all=function(a){return this.root.all(a)},a.prototype.find=function(a){var b;return"string"==typeof a?(b=[],this.each(function(c){return c.componentName===a?b.push(c):void 0}),new e(b)):new e},a.prototype.findById=function(a){return this.componentById[a]},a.prototype.detach=function(){var a;return this.root.componentTree=void 0,this.each(function(a){return function(b){return b.componentTree=void 0,a.componentById[b.id]=void 0}}(this)),a=this.root,this.root=new f({isRoot:!0}),a},a.prototype.setMainView=function(a){var b;return b=a.renderer,i(b,"componentTree.setMainView: view does not have an initialized renderer"),i(b.componentTree===this,"componentTree.setMainView: Cannot set renderer from different componentTree"),this.mainRenderer=b},a.prototype.getMainComponentView=function(a){var b;return null!=(b=this.mainRenderer)?b.getComponentViewById(a):void 0},a.prototype.isDropAllowed=function(a,b){var c,d,e,f;return e=b.target,c=b.componentView,d=b.containerName,"root"===e?this.root.isAllowedAsChild(a):"component"===e?(f=c.model,f.isAllowedAsSibling(a)):"container"===e?(f=c.model,f.isAllowedAsChild(d,a)):void 0},a.prototype.print=function(){var a,b,c;return b="ComponentTree\n-----------\n",a=function(a,c){return null==c&&(c=0),b+=""+Array(c+1).join(" ")+a+"\n"},c=function(b,d){var e,f,g,h;null==d&&(d=0),h=b.template,a("- "+h.label+" ("+h.name+")",d),g=b.containers;for(f in g)e=g[f],a(f+":",d+2),e.first&&c(e.first,d+4);return b.next?c(b.next,d):void 0},this.root.first&&c(this.root.first),b},a.prototype.attachingComponent=function(a,b){return a.componentTree===this?(b(),this.fireEvent("componentMoved",a)):(null!=a.componentTree&&a.remove(),a.descendantsAndSelf(function(b){return function(c){return c.componentTree=b,b.componentById[c.id]=a}}(this)),b(),this.fireEvent("componentAdded",a))},a.prototype.fireEvent=function(){var a,b;return b=arguments[0],a=2<=arguments.length?k.call(arguments,1):[],this[b].fire.apply(void 0,a),this.changed.fire()},a.prototype.detachingComponent=function(a,b){return i(a.componentTree===this,"cannot remove component from another ComponentTree"),a.descendantsAndSelf(function(a){return function(b){return b.componentTree=void 0,a.componentById[b.id]=void 0}}(this)),b(),this.fireEvent("componentRemoved",a)},a.prototype.contentChanging=function(a,b){return this.fireEvent("componentContentChanged",a,b)},a.prototype.htmlChanging=function(a){return this.fireEvent("componentHtmlChanged",a)},a.prototype.dataChanging=function(a,b){return this.fireEvent("componentDataChanged",a,b)},a.prototype.printJson=function(){return words.readableJson(this.toJson())},a.prototype.serialize=function(){var a,b,c;return b={},b.content=[],b.design={name:this.design.name,version:this.design.version},a=function(a,b,c){var d;return d=a.toJson(),c.push(d),d},c=function(b,d,e){var f,g,h,i,j;g=a(b,d,e),j=b.containers;for(i in j)f=j[i],h=g.containers[f.name]=[],f.first&&c(f.first,d+1,h);return b.next?c(b.next,d,e):void 0},this.root.first&&c(this.root.first,0,b.content),b},a.prototype.fromData=function(a,b,c){var d,e,f,g,h;if(null==c&&(c=!0),null!=b?i(null==this.design||b.equals(this.design),"Error loading data. Specified design is different from current componentTree design"):b=this.design,c&&(this.root.componentTree=void 0),a.content)for(h=a.content,f=0,g=h.length;g>f;f++)e=h[f],d=j.fromJson(e,b),this.root.append(d);return c?(this.root.componentTree=this,this.root.each(function(a){return function(b){return b.componentTree=a,a.componentById[b.id]=b}}(this))):void 0},a.prototype.addData=function(a,b){return this.fromData(a,b,!1)},a.prototype.addDataWithAnimation=function(a,b){var c,d,e,f,g,h,k;for(null==b&&(b=200),i(null!=this.design,"Error adding data. ComponentTree has no design"),k=Number(b),g=a.content,d=function(a){return function(){var b;return b=c,setTimeout(function(){var c;return c=j.fromJson(b,a.design),a.root.append(c)},k)}}(this),h=[],e=0,f=g.length;f>e;e++)c=g[e],d(),h.push(k+=Number(b));return h},a.prototype.toData=function(){return this.serialize()},a.prototype.fromJson=function(){var a;return a=1<=arguments.length?k.call(arguments,0):[],this.fromData.apply(this,a)},a.prototype.toJson=function(){var a;return a=1<=arguments.length?k.call(arguments,0):[],this.toData.apply(this,a)},a}()},{"../modules/logging/assert":49,"./component_array":13,"./component_container":14,"./component_model":17,"./component_model_serializer":18,jquery:"jquery"}],20:[function(a,b,c){var d,e,f,g,h=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},i={}.hasOwnProperty;f=a("../modules/logging/assert"),g=a("../modules/words"),d=a("./component_directive"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.isEditable=!0,b.prototype.getText=function(){var a;return a=this.getContent(),a?g.extractTextFromHtml(a):""},b}(d)},{"../modules/logging/assert":49,"../modules/words":54,"./component_directive":15}],21:[function(a,b,c){var d,e,f,g,h=function(a,b){return function(){return a.apply(b,arguments)}};g=a("../modules/logging/assert"),f=a("underscore"),d=a("jquery"),b.exports=e=function(){function a(a,b){this.componentTree=a,this.metadataConfig=b,this.onComponentChange=h(this.onComponentChange,this),this.extractAll=h(this.extractAll,this),this.onTreeChange=h(this.onTreeChange,this),this.fields={},this.initEvents(),this.extractAll(),this.setupListeners()}return a.prototype.setupListeners=function(){return this.componentTree.componentAdded.add(this.onTreeChange),this.componentTree.componentRemoved.add(this.onTreeChange),this.componentTree.componentMoved.add(this.onTreeChange),this.componentTree.componentContentChanged.add(this.onComponentChange)},a.prototype.onTreeChange=function(a){var b,c,d,e,g,h,i;c=a.componentName,h=this.metadataConfig.getComponentMap()[c],b={},g=!1,i=this.extractFields(h);for(e in i)d=i[e],f.isEqual(this.fields[e],d)||(g=!0,b[e]=this.fields[e]=d);return g?this.fieldsChanged.fire(b,this.fields):void 0},a.prototype.extractAll=function(){var a;return a=this.metadataConfig.getListOfFields(),this.fields=this.extractFields(a),this.fieldsChanged.fire(this.fields,this.fields),this.fields},a.prototype.extractFields=function(a){var b,c;return b={},c={},f(this.metadataConfig.getComponentMap()).forEach(function(b,d){return c[d]=f.intersection(b,a)}),this.componentTree.each(function(a){return function(d){var e,g,h;return e=d.componentName,(null!=(h=c[e])?h.length:void 0)?(g=a.extractFieldsFromComponent(d,c[e]),f(g).forEach(function(a,d){return f(c).forEach(function(a,b){return c[b]=f.without(a,d)}),b[d]=a})):void 0}}(this)),b},a.prototype.extractFieldsFromComponent=function(a,b){var c,d;return d={},c=a.componentName,b.forEach(function(b){return function(e){var f;return f=b.metadataConfig.getDirectivesByComponentAndField(c,e),f.forEach(function(c){var f,g;if(!d[e]&&(f=a.directives.get(c),!f.isEmpty()))return g=b.extractFieldFromDirective(f,e),d[e]=g})}}(this)),d},a.prototype.onComponentChange=function(a,b){var c,d,e,g,h;return d=a.componentName,g=this.metadataConfig.getFieldsBySource(d,b),c={},h=[],e=a.directives.get(b),f(g).forEach(function(b){return function(d){var g,i,j,k,l;return g=e.isEmpty()?void 0:b.extractFieldFromDirective(e,d),i=null==g,j=null==b.fields[d],k=(null!=(l=b.fields[d])?l.component.id:void 0)===a.id,i&&k?(h.push(d),b.fields[d]=c[d]=void 0):!j&&!k||f.isEqual(b.fields[d],g)?void 0:b.fields[d]=c[d]=g}}(this)),h.length&&f(this.extractFields(h)).forEach(function(a){return function(b,d){return a.fields[d]=c[d]=b}}(this)),f(c).size()?this.fieldsChanged.fire(c,this.fields):void 0},a.prototype.initEvents=function(){return this.fieldsChanged=d.Callbacks()},a.prototype.extractFieldFromDirective=function(a,b){var c,d;return c=this.metadataConfig.getConfigMap()[b].type,"text"===c?d=this.extractTextField(a):"image"!==c?g(!1,"Unknown template type "+c):a.isBase64()?void 0:d=this.extractImageField(a)},a.prototype.extractTextField=function(a){var b;return b=a.getContent(),{content:b,component:a.component,directiveName:a.name,text:a.getText(),type:"text"}},a.prototype.extractImageField=function(a){var b,c;return{component:a.component,directiveName:a.name,type:"image",image:{originalUrl:a.getOriginalUrl(),url:a.getImageUrl(),width:null!=(b=a.getOriginalImageDimensions())?b.width:void 0,height:null!=(c=a.getOriginalImageDimensions())?c.height:void 0,mimeType:a.getMimeType(),imageService:a.getImageServiceName()}}},a.prototype.getFields=function(){return this.fields},a}()},{"../modules/logging/assert":49,jquery:"jquery",underscore:10}],22:[function(a,b,c){var d,e,f,g=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h={}.hasOwnProperty;f=a("../modules/logging/assert"),d=a("./component_directive"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.isHtml=!0,b.prototype.setEmbedHandler=function(a){return this.setData("_embedHandler",a)},b.prototype.getEmbedHandler=function(){return this.getData("_embedHandler")},b}(d)},{"../modules/logging/assert":49,"./component_directive":15}],23:[function(a,b,c){var d,e,f,g,h=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},i={}.hasOwnProperty;f=a("../modules/logging/assert"),g=a("../image_services/image_service"),d=a("./component_directive"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.isImage=!0,b.prototype.setContent=function(a){return this.setImageUrl(a)},b.prototype.getContent=function(){return this.getImageUrl()},b.prototype.isBackgroundImage=function(a){return"img"!==this.templateDirective.getTagName()},b.prototype.isInlineImage=function(a){return"img"===this.templateDirective.getTagName()},b.prototype.isBase64=function(){return!!this.base64Image},b.prototype.setBase64Image=function(a){return this.base64Image=a,this.component.componentTree?this.component.componentTree.contentChanging(this.component,this.name):void 0},b.prototype.setImageUrl=function(a){var b,c;return null==(b=this.component.content)[c=this.name]&&(b[c]={}),this.component.content[this.name].url=a,this.resetCrop(),this.base64Image=void 0,this.processImageUrl(a)},b.prototype.getImageUrl=function(){var a;return a=this.component.content[this.name],a?a.url:void 0},b.prototype.getImageObject=function(){return this.component.content[this.name]},b.prototype.getOriginalUrl=function(){var a;return(null!=(a=this.component.content[this.name])?a.originalUrl:void 0)||this.getImageUrl()},b.prototype.setCrop=function(a){var b,c,d,e,f,g;return b=this.component.content[this.name],null!=(null!=b?b.url:void 0)?(a?(f=a.x,g=a.y,e=a.width,c=a.height,d=a.name,b.crop={x:f,y:g,width:e,height:c,name:d}):delete b.crop,this.processImageUrl(b.originalUrl||b.url),this.component.componentTree?this.component.componentTree.contentChanging(this.component,this.name):void 0):void 0},b.prototype.getCrop=function(){return this.component.content[this.name].crop},b.prototype.setOriginalImageDimensions=function(a){var b,c,d;return d=a.width,c=a.height,b=this.component.content[this.name],b.width=d,b.height=c},b.prototype.getOriginalImageDimensions=function(){var a;return a=this.component.content[this.name],{width:null!=a?a.width:void 0,height:null!=a?a.height:void 0}},b.prototype.setMimeType=function(a){var b,c,d;return null==(b=this.component.content)[d=this.name]&&(b[d]={}),c=this.component.content[this.name],c.mimeType=a},b.prototype.getMimeType=function(){var a;return a=this.component.content[this.name],a?a.mimeType:void 0},b.prototype.resetCrop=function(){var a;return a=this.component.content[this.name],null!=a?a.crop=null:void 0},b.prototype.setImageService=function(a){var b;return f(g.has(a),"Error: could not load image service "+a),b=this.getImageUrl(),this.component.content[this.name]={url:b,imageService:a||null}},b.prototype.getImageServiceName=function(){return this.getImageService().name},b.prototype.hasDefaultImageService=function(){return"default"===this.getImageServiceName()},b.prototype.getImageService=function(){var a,b;return b=null!=(a=this.component.content[this.name])?a.imageService:void 0,g.get(b||void 0)},b.prototype.processImageUrl=function(a){var b,c;return this.hasDefaultImageService()?void 0:(c=this.getImageService(),b=this.getImageObject(),b.url=c.getUrl(a,{crop:b.crop}),b.originalUrl=a)},b}(d)},{"../image_services/image_service":36,"../modules/logging/assert":49,"./component_directive":15}],24:[function(a,b,c){var d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;d=a("./component_directive"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.isLink=!0,b}(d)},{"./component_directive":15}],25:[function(a,b,c){b.exports=function(a){var b,c,d,e;a.docDirective={},a.templateAttrLookup={},d=a.directives;for(b in d)e=d[b],c=a.attributePrefix?a.attributePrefix+"-":"",e.renderedAttr=""+c+e.attr,a.docDirective[b]=e.renderedAttr,a.templateAttrLookup[e.attr]=b;return a}},{}],26:[function(a,b,c){var d;d=a("./augment_config"),b.exports=d({loadResources:!0,ignoreInteraction:".ld-control",livingdocsCssFile:"/assets/css/livingdocs.css",wordSeparators:"./\\()\"':,.;<>~!#%^&*|+=[]{}`~?",singleLineBreak:/^<br\s*\/?>\s*$/,attributePrefix:"data",editable:{allowNewline:!0,changeDelay:0,browserSpellcheck:!1,mouseMoveSelectionChanges:!1},css:{section:"doc-section",component:"doc-component",editable:"doc-editable",noPlaceholder:"doc-no-placeholder",emptyImage:"doc-image-empty","interface":"doc-ui",componentHighlight:"doc-component-highlight",containerHighlight:"doc-container-highlight",dragged:"doc-dragged",draggedPlaceholder:"doc-dragged-placeholder",draggedPlaceholderCounter:"doc-drag-counter",dragBlocker:"doc-drag-blocker",dropMarker:"doc-drop-marker",beforeDrop:"doc-before-drop",noDrop:"doc-drag-no-drop",afterDrop:"doc-after-drop",longpressIndicator:"doc-longpress-indicator",preventSelection:"doc-no-selection",maximizedContainer:"doc-js-maximized-container",interactionBlocker:"doc-interaction-blocker"},attr:{template:"data-doc-template",placeholder:"data-doc-placeholder"},directives:{container:{attr:"doc-container",renderedAttr:"calculated in augment_config",overwritesContent:!0},editable:{attr:"doc-editable",renderedAttr:"calculated in augment_config",overwritesContent:!0},html:{attr:"doc-html",renderedAttr:"calculated in augment_config",overwritesContent:!0},image:{attr:"doc-image",renderedAttr:"calculated in augment_config"},link:{attr:"doc-link",renderedAttr:"calculated in augment_config"},optional:{attr:"doc-optional",renderedAttr:"calculated in augment_config",modifies:["editable"]}},animations:{optionals:{show:function(a){return a.slideDown(250)},hide:function(a){return a.slideUp(250)}}},imagePlaceholder:"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="620" height="350" viewBox="0 0 620 350" preserveAspectRatio="none"><rect width="620" height="350" fill="#D4D4CE"/><line x1="0" y1="0" x2="620" y2="350" style="stroke:#ffffff;stroke-width:2"/><line x1="620" y1="0" x2="0" y2="350" style="stroke:#ffffff;stroke-width:2"/></svg>'),imageServices:{"resrc.it":{quality:75,host:"https://app.resrc.it"}}})},{"./augment_config":25}],27:[function(a,b,c){var d;b.exports=d=function(){function a(a){this.fieldsArray=[],this.editableFieldsArray=[],this.fieldMap={},this.configMap={},this.componentDirectiveMap={},this.componentMap={},null!=a&&a.length&&this.parse(a)}return a.prototype.parse=function(a){var b,c,d,e,f,g,h,i,j,k,l;for(k=[],g=0,i=a.length;i>g;g++)e=a[g],f=e.identifier,l=e.type,this.fieldsArray.push(f),this.configMap[f]=e,null==(b=this.fieldMap)[f]&&(b[f]={}),h=null!=e.isEditable?!!e.isEditable:!0,h&&this.editableFieldsArray.push(f),k.push(function(){var a,b,g,h,i,k,l,m,n;for(l=e.matches,n=[],i=0,k=l.length;k>i;i++)j=l[i],m=j.split("."),c=m[0],d=m[1],null==(a=this.componentDirectiveMap)[c]&&(a[c]={}),null==(b=this.componentDirectiveMap[c])[d]&&(b[d]=[]),this.componentDirectiveMap[c][d].push(f),null==(g=this.componentMap)[c]&&(g[c]=[]),this.componentMap[c].push(f),null==(h=this.fieldMap[f])[c]&&(h[c]=[]),n.push(this.fieldMap[f][c].push(d));return n}.call(this));return k},a.prototype.getListOfEditableFields=function(){return this.editableFieldsArray},a.prototype.getListOfFields=function(){return this.fieldsArray},a.prototype.getConfigMap=function(){return this.configMap},a.prototype.getComponentMap=function(){return this.componentMap},a.prototype.getFieldsBySource=function(a,b){var c;return(null!=(c=this.componentDirectiveMap[a])?c[b]:void 0)||[]},a.prototype.getDirectivesByComponentAndField=function(a,b){return this.fieldMap[b][a]},a}()},{}],28:[function(a,b,c){var d,e,f,g;f=a("../modules/logging/log"),e=a("../modules/logging/assert"),g=a("../modules/words"),b.exports=d=function(){function a(a){var b,c,d;switch(this.name=a.name,b=a.label,this.type=a.type,d=a.value,c=a.options,this.label=b||g.humanize(this.name),this.type){case"option":e(d,"TemplateStyle error: no 'value' provided"),this.value=d;break;case"select":e(c,"TemplateStyle error: no 'options' provided"),this.options=c;break;default:f.error("TemplateStyle error: unknown type '"+this.type+"'")}}return a.prototype.cssClassChanges=function(a){if(this.validateValue(a)){if("option"===this.type)return{remove:a?void 0:[this.value],add:a};if("select"===this.type)return{remove:this.otherClasses(a),add:a}}else{if("option"===this.type)return{remove:currentValue,add:void 0};if("select"===this.type)return{remove:this.otherClasses(void 0),add:void 0}}},a.prototype.validateValue=function(a){return a?"option"===this.type?a===this.value:"select"===this.type?this.containsOption(a):f.warn("Not implemented: CssModificatorProperty#validateValue() for type "+this.type):!0},a.prototype.containsOption=function(a){var b,c,d,e;for(e=this.options,b=0,c=e.length;c>b;b++)if(d=e[b],a===d.value)return!0;return!1},a.prototype.otherOptions=function(a){var b,c,d,e,f;for(e=[],f=this.options,b=0,c=f.length;c>b;b++)d=f[b],d.value!==a&&e.push(d);return e},a.prototype.otherClasses=function(a){var b,c,d,e,f;for(e=[],f=this.options,b=0,c=f.length;c>b;b++)d=f[b],d.value!==a&&e.push(d.value);return e},a}()},{"../modules/logging/assert":49,"../modules/logging/log":50,"../modules/words":54}],29:[function(a,b,c){var d,e,f,g,h,i,j,k,l;j=a("../configuration/config"),i=a("../modules/logging/assert"),k=a("../modules/logging/log"),l=a("../modules/words"),g=a("../template/template"),f=a("../modules/ordered_hash"),d=a("../rendering/dependencies"),h=a("underscore"),b.exports=e=function(){function a(b){var c;this.name=b.name,this.version=b.version,c=b.label,this.author=b.author,this.description=b.description,i(null!=this.name,'Design: param "name" is required'),this.label=c||l.humanize(this.name),this.identifier=a.getIdentifier(this.name,this.version),this.groups=[],this.components=new f,this.imageRatios={},this.dependencies=new d,this.defaultParagraph=void 0,this.defaultImage=void 0}return a.prototype.equals=function(a){return a.name===this.name&&a.version===this.version},a.prototype.isNewerThan=function(a){return null==a?!0:this.version>(a.version||"")},a.prototype.get=function(a){var b;return b=this.getComponentNameFromIdentifier(a),this.components.get(b)},a.prototype.each=function(a){return this.components.each(a)},a.prototype.add=function(a){return a.setDesign(this),
this.components.push(a.name,a)},a.prototype.getComponentNameFromIdentifier=function(a){var b;return b=g.parseIdentifier(a).name},a.prototype.getDefaultParagraphTemplate=function(){return this.defaultParagraph},a.prototype.getDefaultImageTemplate=function(){return this.defaultImage},a.prototype.getDefaultParagraphComponentName=function(){var a;return null!=(a=this.getDefaultParagraphTemplate())?a.name:void 0},a.prototype.getDefaultImageComponentName=function(){var a;return null!=(a=this.getDefaultImageTemplate())?a.name:void 0},a.prototype.getDefaultImageDirectiveName=function(){var a,b;return null!=(a=this.defaultImage)&&null!=(b=a.directives.firstOfType("image"))?b.name:void 0},a.prototype.getLayout=function(a){return this.layouts?null==a&&null==this.defaultLayout?h.first(this.layouts):(null==a&&(a=this.defaultLayout),h.findWhere(this.layouts,{name:a})):{wrapper:this.wrapper}},a.getIdentifier=function(a,b){return b?a+"@"+b:""+a},a}()},{"../configuration/config":26,"../modules/logging/assert":49,"../modules/logging/log":50,"../modules/ordered_hash":51,"../modules/words":54,"../rendering/dependencies":56,"../template/template":73,underscore:10}],30:[function(a,b,c){var d,e,f,g;f=a("../modules/logging/assert"),d=a("./design"),g=a("./design_parser"),e=a("./version"),b.exports=function(){return{designs:{},load:function(a,b){var c,h,i,j;if(c=(null!=b?b:{}).basePath,f(null!=a,"design.load() was called with undefined."),f(!("string"==typeof a),"design.load() loading a design by name is not implemented."),j=e.parse(a.version),i=d.getIdentifier(a.name,j),!this.has(i)){if(null!=c&&null!=a.assets&&(a.assets.basePath=c),h=g.parse(a))return this.add(h);throw new Error(d.parser.errors)}},add:function(a){return a.isNewerThan(this.designs[a.name])&&(this.designs[a.name]=a),this.designs[a.identifier]=a},has:function(a){return null!=this.designs[a]},get:function(a){return f(this.has(a),"Error: design '"+a+"' is not loaded."),this.designs[a]},resetCache:function(){return this.designs={}}}}()},{"../modules/logging/assert":49,"./design":29,"./design_parser":32,"./version":34}],31:[function(a,b,c){var d,e,f,g;e=a("../configuration/config"),f=a("jscheme"),d=a("./version"),b.exports=g=f["new"](),g.add("styleType",function(a){return"option"===a||"select"===a}),g.add("semVer",function(a){return d.semVer.test(a)}),g.add("wrapper",function(a){var b;return b=/<.*\u0020(?:[^>]*\u0020|)class=("|')[^'"]*doc-section[^'"]*\1(?:\u0020[^>]*|)>/,b.test(a)?!0:"design.wrapper is missing a 'doc-section' class ('"+a+"')."}),g.add("one empty option",function(a){var b,c,d,e;for(b=0,d=0,e=a.length;e>d;d++)c=a[d],c.value||(b+=1);return 1===b}),g.add("design",{name:"string",label:"string, optional",version:"string, semVer",author:"string, optional",description:"string, optional",assets:{__validate:"optional",css:"array of string",js:"array of string, optional",basePath:"string, optional"},components:"array of component",componentProperties:{__validate:"optional",__additionalProperty:function(a,b){return g.validate("componentProperty",b)}},groups:"array of group, optional",defaultComponents:{__validate:"optional",paragraph:"string, optional",image:"string, optional"},imageRatios:{__validate:"optional",__additionalProperty:function(a,b){return g.validate("imageRatio",b)}},metadata:"array of object, optional",wrapper:"string, wrapper, optional",layouts:"array of layout, optional",defaultLayout:"string, optional",defaultContent:"array of object, optional",prefilledComponents:"object, optional"}),g.add("component",{name:"string",label:"string, optional",html:"string",directives:"object, optional",properties:"array of string, optional",allowedParents:"array of string, optional",__additionalProperty:function(a,b){return!1}}),g.add("group",{label:"string",components:"array of string"}),g.add("componentProperty",{label:"string, optional",type:"string, styleType",value:"string, optional",options:"array of styleOption, one empty option, optional"}),g.add("imageRatio",{label:"string, optional",ratio:"string"}),g.add("styleOption",{caption:"string",value:"string, optional"}),g.add("layout",{name:"string",caption:"string",wrapper:"wrapper",icon:"string, optional"})},{"../configuration/config":26,"./version":34,jscheme:4}],32:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m;m=a("../modules/logging/log"),d=a("jquery"),j=a("../modules/logging/assert"),k=a("./design_config_schema"),e=a("./css_modificator_property"),h=a("../template/template"),f=a("./design"),i=a("./version"),g=a("./image_ratio"),d=a("jquery"),b.exports=l={parse:function(a){var b;if(this.design=void 0,k.validate("design",a))return this.createDesign(a);throw b=k.getErrorMessages(),new Error(b)},createDesign:function(a){var b,c,e,f,g,h,i;b=a.assets,e=a.components,c=a.componentProperties,h=a.groups,f=a.defaultComponents,i=a.imageRatios;try{this.design=this.parseDesignInfo(a),d.each(["metadata","wrapper","layouts","defaultLayout","defaultContent","prefilledComponents"],function(b){return function(c,d){return b.design[d]=a[d]}}(this)),this.parseAssets(b),this.parseComponentProperties(c),this.parseImageRatios(i),this.parseComponents(e),this.parseGroups(h),this.parseDefaults(f)}catch(j){throw g=j,g.message="Error creating the design: "+g.message,g}return this.design},parseDesignInfo:function(a){var b;return b=new i(a.version),new f({name:a.name,label:a.label,version:b.toString()})},parseAssets:function(a){var b;if(null!=a)return b=a.basePath,this.eachAsset(a.js,function(a){return function(c){return a.design.dependencies.addJs({src:c,basePath:b})}}(this)),this.eachAsset(a.css,function(a){return function(c){return a.design.dependencies.addCss({src:c,basePath:b})}}(this))},eachAsset:function(a,b){var c,e,f,g;if(null!=a){if("string"===d.type(a))return b(a);for(g=[],e=0,f=a.length;f>e;e++)c=a[e],g.push(b(c));return g}},parseComponentProperties:function(a){var b,c,d;this.componentProperties={},d=[];for(c in a)b=a[c],b.name=c,d.push(this.componentProperties[c]=this.createComponentProperty(b));return d},parseImageRatios:function(a){var b,c,d;d=[];for(b in a)c=a[b],d.push(this.design.imageRatios[b]=new g({name:b,label:c.label,ratio:c.ratio}));return d},parseComponents:function(a){var b,c,d,e,f,g,i,j,k,l,m;for(null==a&&(a=[]),l=[],e=0,g=a.length;g>e;e++)k=a[e],i=k.name,f=k.label,d=k.html,j=k.properties,c=k.directives,b=k.allowedParents,j=this.lookupComponentProperties(j),m=new h({name:i,label:f,html:d,properties:j,allowedParents:b}),this.parseDirectives(m,c),l.push(this.design.add(m));return l},parseDirectives:function(a,b){var c,e,f,g,h;h=[];for(g in b)c=b[g],e=a.directives.get(g),j(e,"Could not find directive "+g+" in "+a.name+" component."),f=d.extend({},c),c.imageRatios&&(f.imageRatios=this.lookupImageRatios(c.imageRatios)),h.push(e.setConfig(f));return h},lookupComponentProperties:function(a){var b,c,d,e,f,g;for(e={},g=a||[],b=0,c=g.length;c>b;b++)d=g[b],f=this.componentProperties[d],j(f,"The componentProperty '"+d+"' was not found."),e[d]=f;return e},lookupImageRatios:function(a){return null!=a?this.mapArray(a,function(a){return function(b){var c;return c=a.design.imageRatios[b],j(c,"The imageRatio '"+b+"' was not found."),c}}(this)):void 0},parseGroups:function(a){var b,c,d,e,f,g;for(null==a&&(a=[]),g=[],e=0,f=a.length;f>e;e++)d=a[e],c=function(){var a,c,e,f;for(e=d.components,f=[],a=0,c=e.length;c>a;a++)b=e[a],f.push(this.design.get(b));return f}.call(this),g.push(this.design.groups.push({label:d.label,components:c}));return g},parseDefaults:function(a){var b,c;if(null!=a)return c=a.paragraph,b=a.image,c&&(this.design.defaultParagraph=this.getTemplate(c)),b?this.design.defaultImage=this.getTemplate(b):void 0},getTemplate:function(a){var b;return b=this.design.get(a),j(b,"Could not find component "+a),b},createComponentProperty:function(a){return new e(a)},mapArray:function(a,b){var c,d,e,f,g;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],g=b(c),null!=g&&f.push(g);return f}},f.parser=l},{"../modules/logging/assert":49,"../modules/logging/log":50,"../template/template":73,"./css_modificator_property":28,"./design":29,"./design_config_schema":31,"./image_ratio":33,"./version":34,jquery:"jquery"}],33:[function(a,b,c){var d,e,f,g;d=a("jquery"),g=a("../modules/words"),f=a("../modules/logging/assert"),b.exports=e=function(){function a(a){var b,c;this.name=a.name,b=a.label,c=a.ratio,this.label=b||g.humanize(this.name),this.ratio=this.parseRatio(c)}var b;return b=/(\d+)[\/:x](\d+)/,a.prototype.parseRatio=function(a){var c;return"string"===d.type(a)&&(c=b.exec(a),a=Number(c[1])/Number(c[2])),f("number"===d.type(a),"Could not parse image ratio "+a),a},a}()},{"../modules/logging/assert":49,"../modules/words":54,jquery:"jquery"}],34:[function(a,b,c){var d;b.exports=d=function(){function a(a){this.parseVersion(a)}return a.semVer=/(\d+)\.(\d+)\.(\d+)(.+)?/,a.prototype.parseVersion=function(b){var c;return c=a.semVer.exec(b),c?(this.major=c[1],this.minor=c[2],this.patch=c[3],this.addendum=c[4]):void 0},a.prototype.isValid=function(){return null!=this.major},a.prototype.toString=function(){return this.major+"."+this.minor+"."+this.patch+(this.addendum||"")},a.parse=function(b){var c;return c=new a(b),c.isValid()?c.toString():""},a}()},{}],35:[function(a,b,c){b.exports={name:"default",set:function(a,b){return this.isInlineImage(a)?this.setInlineImage(a,b):this.setBackgroundImage(a,b)},getUrl:function(a){return a},setInlineImage:function(a,b){return a.attr("src",b)},setBackgroundImage:function(a,b){return a.css("background-image","url("+this.escapeCssUri(b)+")")},escapeCssUri:function(a){return/[()]/.test(a)?"'"+a+"'":a},getImageDimensions:function(a){return this.isInlineImage(a)?{width:a.width(),height:a.height()}:{width:a.outerWidth(),height:a.outerHeight()}},isBase64:function(a){return null!=a?0===a.indexOf("data:image"):void 0},isInlineImage:function(a){return"img"===a[0].nodeName.toLowerCase()},isBackgroundImage:function(a){return"img"!==a[0].nodeName.toLowerCase()}}},{}],36:[function(a,b,c){var d,e,f;d=a("../modules/logging/assert"),e=a("./default_image_service"),f=a("./resrcit_image_service"),b.exports=function(){var a;return a={"resrc.it":f,"default":e},{has:function(b){return null==b&&(b="default"),null!=a[b]},get:function(b){return null==b&&(b="default"),d(this.has(b),"Could not load image service "+b),a[b]},eachService:function(b){var c,d,e;d=[];for(c in a)e=a[c],d.push(b(c,e));return d}}}()},{"../modules/logging/assert":49,"./default_image_service":35,"./resrcit_image_service":37}],37:[function(a,b,c){var d,e,f;d=a("../modules/logging/assert"),e=a("./default_image_service"),f=a("../configuration/config").imageServices["resrc.it"],b.exports=function(){return{name:"resrc.it",set:function(a,b){return d(null!=b&&""!==b,"Src value for an image has to be defined"),e.isBase64(b)?this.setBase64(a,b):(a.addClass("resrc"),e.isInlineImage(a)?this.setInlineImage(a,b):this.setBackgroundImage(a,b))},getUrl:function(a,b){var c,e,g,h,i,j,k,l,m;return i=null!=b?b:{},c=i.crop,h=i.quality,j="",null!=c&&(l=c.x,m=c.y,k=c.width,e=c.height,d("number"==typeof l,"x should be a number"),d("number"==typeof m,"y should be a number"),d("number"==typeof k,"width should be a number"),d("number"==typeof e,"height should be a number"),j+="/C=W"+k+",H"+e+",X"+l+",Y"+m),(g=h||f.quality)&&(j+="/O="+g),""+f.host+j+"/"+a},formatCssUrl:function(a){return a=e.escapeCssUri(a),"url("+a+")"},setInlineImage:function(a,b){return e.isBase64(a.attr("src"))&&a.removeAttr("src"),a.attr("data-src",b)},setBackgroundImage:function(a,b){return a.css("background-image",this.formatCssUrl(b))},setBase64:function(a,b){return e.set(a,b)}}}()},{"../configuration/config":26,"../modules/logging/assert":49,"./default_image_service":35}],38:[function(a,b,c){var d,e,f,g,h,i;d=a("jquery"),h=a("./dom"),i=a("../modules/feature_detection/is_supported"),f=a("../configuration/config"),g=f.css,b.exports=e=function(){function a(a){var b;this.componentModel=a.componentModel,b=a.componentView,b&&(this.$view=b.$html),this.$highlightedContainer={}}var b,c;return c=0,b=0,a.prototype.start=function(a){return this.started=!0,this.page.editableController.disableAll(),this.page.blurFocusedElement(),this.$placeholder=this.createPlaceholder().css({"pointer-events":"none"}),this.$dragBlocker=this.page.$body.find("."+g.dragBlocker),this.$dropMarker=d("<div class='"+g.dropMarker+"'>"),this.page.$body.append(this.$dropMarker).append(this.$placeholder).css("cursor","pointer"),null!=this.$view&&this.$view.addClass(g.dragged),this.move(a)},a.prototype.move=function(a){return this.$placeholder.css({left:a.pageX+"px",top:a.pageY+"px"}),this.target=this.findDropTarget(a)},a.prototype.findDropTarget=function(a){var b,c,d,e,f;return d=this.getElemUnderCursor(a),a=d.eventPosition,c=d.elem,null==c?void 0:c===this.$dropMarker[0]?this.target:(b={left:a.pageX,top:a.pageY},null!=c&&(f=h.dropTarget(c,b)),this.canBeDropped(f)||(f=void 0),this.undoMakeSpace(),null!=f&&(null!=(e=f.componentView)?e.model:void 0)!==this.componentModel?(this.$placeholder.removeClass(g.noDrop),this.markDropPosition(f),f):(this.$dropMarker.hide(),this.removeContainerHighlight(),void(null==f?this.$placeholder.addClass(g.noDrop):this.$placeholder.removeClass(g.noDrop))))},a.prototype.canBeDropped=function(a){var b,c;return null==a?!1:(b=a.componentTree,null==b&&(b=a.componentView.model.componentTree),c=b.isDropAllowed(this.componentModel,a))},a.prototype.markDropPosition=function(a){switch(a.target){case"component":return this.componentPosition(a),this.removeContainerHighlight();case"container":return this.showMarkerAtBeginningOfContainer(a.node),this.highlighContainer(d(a.node));case"root":return this.showMarkerAtBeginningOfContainer(a.node),this.highlighContainer(d(a.node))}},a.prototype.componentPosition=function(a){var b,c;return"before"===a.position?(b=a.componentView.prev(),null!=b?b.model===this.componentModel?(a.position="after",this.componentPosition(a)):this.showMarkerBetweenComponents(b,a.componentView):this.showMarkerAtBeginningOfContainer(a.componentView.$elem[0].parentNode)):(c=a.componentView.next(),null!=c?c.model===this.componentModel?(a.position="before",this.componentPosition(a)):this.showMarkerBetweenComponents(a.componentView,c):this.showMarkerAtEndOfContainer(a.componentView.$elem[0].parentNode))},a.prototype.showMarkerBetweenComponents=function(a,b){var c,d,e;return c=h.getAbsoluteBoundingClientRect(a.$elem[0]),d=h.getAbsoluteBoundingClientRect(b.$elem[0]),e=d.top>c.bottom?(d.top-c.bottom)/2:0,this.showMarker({left:c.left,top:c.bottom+e,width:c.width})},a.prototype.showMarkerAtBeginningOfContainer=function(a){var c,e;if(null!=a)return this.makeSpace(a.firstChild,"top"),c=h.getAbsoluteBoundingClientRect(a),e=parseInt(d(a).css("padding-top"))||0,this.showMarker({left:c.left,top:c.top+b+e,width:c.width})},a.prototype.showMarkerAtEndOfContainer=function(a){var c,e;if(null!=a)return this.makeSpace(a.lastChild,"bottom"),c=h.getAbsoluteBoundingClientRect(a),e=parseInt(d(a).css("padding-bottom"))||0,this.showMarker({left:c.left,top:c.bottom-b-e,width:c.width})},a.prototype.showMarker=function(a){var b,c,e,f;return c=a.left,e=a.top,f=a.width,null!=this.iframeBox?(b=d(this.iframeBox.window.document.body),e-=b.scrollTop(),c-=b.scrollLeft(),c+=this.iframeBox.left,e+=this.iframeBox.top,this.$dropMarker.css({position:"fixed"})):this.$dropMarker.css({position:"absolute"}),this.$dropMarker.css({left:c+"px",top:e+"px",width:f+"px"}).show()},a.prototype.makeSpace=function(a,b){var e;if(c&&null!=a)return e=d(a),this.lastTransform=e,e.css("top"===b?{transform:"translate(0, "+c+"px)"}:{transform:"translate(0, -"+c+"px)"})},a.prototype.undoMakeSpace=function(a){return null!=this.lastTransform?(this.lastTransform.css({transform:""}),this.lastTransform=void 0):void 0},a.prototype.highlighContainer=function(a){var b,c;return a[0]!==this.$highlightedContainer[0]?("function"==typeof(b=this.$highlightedContainer).removeClass&&b.removeClass(g.containerHighlight),this.$highlightedContainer=a,"function"==typeof(c=this.$highlightedContainer).addClass?c.addClass(g.containerHighlight):void 0):void 0},a.prototype.removeContainerHighlight=function(){var a;return"function"==typeof(a=this.$highlightedContainer).removeClass&&a.removeClass(g.containerHighlight),this.$highlightedContainer={}},a.prototype.getElemUnderCursor=function(a){var b;return b=void 0,this.unblockElementFromPoint(function(c){return function(){var d,e,f;return d=a.clientX,e=a.clientY,null!=d&&null!=e&&(b=c.page.document.elementFromPoint(d,e)),"IFRAME"===(null!=b?b.nodeName:void 0)?(f=c.findElemInIframe(b,a),a=f.eventPosition,b=f.elem,f):c.iframeBox=void 0}}(this)),{eventPosition:a,elem:b}},a.prototype.findElemInIframe=function(a,b){var c,e,f,g;return this.iframeBox=e=a.getBoundingClientRect(),this.iframeBox.window=a.contentWindow,f=a.contentDocument,c=d(f.body),b.clientX-=e.left,b.clientY-=e.top,b.pageX=b.clientX+c.scrollLeft(),b.pageY=b.clientY+c.scrollTop(),g=f.elementFromPoint(b.clientX,b.clientY),{eventPosition:b,elem:g}},a.prototype.unblockElementFromPoint=function(a){return i("htmlPointerEvents")?(this.$dragBlocker.css({"pointer-events":"none"}),a(),this.$dragBlocker.css({"pointer-events":"auto"})):(this.$dragBlocker.hide(),this.$placeholder.hide(),a(),this.$dragBlocker.show(),this.$placeholder.show())},a.prototype.drop=function(){return null!=this.target?(this.moveToTarget(this.target),this.page.componentWasDropped.fire(this.componentModel)):void 0},a.prototype.moveToTarget=function(a){var b,c,d;switch(a.target){case"component":return d=a.componentView,"before"===a.position?d.model.before(this.componentModel):d.model.after(this.componentModel);case"container":return b=a.componentView.model,b.append(a.containerName,this.componentModel);case"root":return c=a.componentTree,c.prepend(this.componentModel)}},a.prototype.reset=function(){return this.started?(this.undoMakeSpace(),this.removeContainerHighlight(),this.page.$body.css("cursor",""),this.page.editableController.reenableAll(),null!=this.$view&&this.$view.removeClass(g.dragged),h.restoreContainerHeight(),this.$placeholder.remove(),this.$dropMarker.remove()):void 0},a.prototype.createPlaceholder=function(){var a,b,c;return b=1,c='<div class="'+g.draggedPlaceholder+'">\n  <span class="'+g.draggedPlaceholderCounter+'">\n    '+b+"\n  </span>\n  Selected Item\n</div>",a=d(c).css({position:"absolute"})},a}()},{"../configuration/config":26,"../modules/feature_detection/is_supported":47,"./dom":40,jquery:"jquery"}],39:[function(a,b,c){var d;b.exports=d=function(){function a(a){var b,c;this.target=a.target,c=a.focus,b=a.blur,this.type=c?"containerFocus":b?"containerBlur":void 0}return a}()},{}],40:[function(a,b,c){var d,e,f,g;d=a("jquery"),e=a("../configuration/config"),g=a("../template/directive_finder"),f=e.css,b.exports=function(){var a,b;return a=new RegExp("(?: |^)"+f.component+"(?: |$)"),b=new RegExp("(?: |^)"+f.section+"(?: |$)"),{findComponentView:function(b){var c;for(b=this.getElementNode(b);b&&1===b.nodeType;){if(a.test(b.className))return c=this.getComponentView(b);b=b.parentNode}return void 0},getDirectiveContext:function(a){var b;for(a=this.getElementNode(a);a&&1===a.nodeType;){if(b=this.getDirectives(a))return b;a=a.parentNode}return void 0},isInsideDocLink:function(a){for(var b;a&&1===a.nodeType;){if(b=this.getDirectives(a),null!=b?b.link:void 0)return!0;a=a.parentNode}return!1},getDirectives:function(a){var b;return b=void 0,g.eachDirective(a,function(a,c){return"optional"!==a?(null==b&&(b={}),b[a]={type:a,name:c}):void 0}),b},findContainer:function(a){var c,d,f;for(a=this.getElementNode(a),c=e.directives.container.renderedAttr;a&&1===a.nodeType;){if(a.hasAttribute(c))return d=a.getAttribute(c),b.test(a.className)||(f=this.findComponentView(a)),{node:a,containerName:d,componentView:f};a=a.parentNode}return{}},getImageName:function(a){var b,c;return b=e.directives.image.renderedAttr,a.hasAttribute(b)?c=a.getAttribute(b):void 0},getHtmlElementName:function(a){var b,c;return b=e.directives.html.renderedAttr,a.hasAttribute(b)?c=a.getAttribute(b):void 0},getEditableName:function(a){var b,c;return b=e.directives.editable.renderedAttr,a.hasAttribute(b)?(c=a.getAttribute(b),editableName):void 0},dropTarget:function(c,d){var f,g,h,i;for(i=d.top,h=d.left,c=this.getElementNode(c),g=e.directives.container.renderedAttr;c&&1===c.nodeType;){if(c.hasAttribute(g))return f=this.getClosestComponent(c,{top:i,left:h}),null!=f?this.getClosestComponentTarget(f):this.getContainerTarget(c);if(a.test(c.className))return this.getComponentTarget(c,{top:i,left:h});if(b.test(c.className))return f=this.getClosestComponent(c,{top:i,left:h}),null!=f?this.getClosestComponentTarget(f):this.getRootTarget(c);c=c.parentNode}},getComponentTarget:function(a,b){var c,d,e;return e=b.top,c=b.left,d=b.position,{target:"component",componentView:this.getComponentView(a),position:d||this.getPositionOnComponent(a,{top:e,left:c})}},getClosestComponentTarget:function(a){var b,c;return b=a.$elem[0],c=a.position,this.getComponentTarget(b,{position:c})},getContainerTarget:function(a){var b,c;return b=e.directives.container.renderedAttr,c=a.getAttribute(b),{target:"container",node:a,componentView:this.findComponentView(a),containerName:c}},getRootTarget:function(a){var b;return b=d(a).data("componentTree"),{target:"root",node:a,componentTree:b}},getPositionOnComponent:function(a,b){var c,e,f,g,h,i;return i=b.top,h=b.left,c=d(a),g=c.offset().top,f=c.outerHeight(),e=g+f,this.distance(i,g)<this.distance(i,e)?"before":"after"},getClosestComponent:function(a,b){var c,e,g,h,i;return i=b.top,h=b.left,c=d(a).find("."+f.component),e=void 0,g=void 0,c.each(function(a){return function(b,c){var f,h,j,k;return f=d(c),k=f.offset().top,j=f.outerHeight(),h=k+j,(null==e||a.distance(i,k)<e)&&(e=a.distance(i,k),g={$elem:f,position:"before"}),null==e||a.distance(i,h)<e?(e=a.distance(i,h),g={$elem:f,position:"after"}):void 0}}(this)),g},distance:function(a,b){return a>b?a-b:b-a},maximizeContainerHeight:function(a){var b,c,e,g,h,i,j,k;if(a.template.containerCount>1){j=a.containers,k=[];for(g in j)e=j[g],b=d(e),b.hasClass(f.maximizedContainer)||(c=b.parent(),i=c.height(),h=b.outerHeight(!0)-b.height(),b.height(i-h),k.push(b.addClass(f.maximizedContainer)));return k}},restoreContainerHeight:function(){return d("."+f.maximizedContainer).css("height","").removeClass(f.maximizedContainer)},getElementNode:function(a){return(null!=a?a.jquery:void 0)?a[0]:3===(null!=a?a.nodeType:void 0)?a.parentNode:a},getComponentView:function(a){return d(a).data("componentView")},getAbsoluteBoundingClientRect:function(a){var b,c,d,e,f;return f=a.ownerDocument.defaultView,c=this.getScrollPosition(f),d=c.scrollX,e=c.scrollY,b=a.getBoundingClientRect(),b={top:b.top+e,bottom:b.bottom+e,left:b.left+d,right:b.right+d},b.height=b.bottom-b.top,b.width=b.right-b.left,b},getScrollPosition:function(a){return{scrollX:void 0!==a.pageXOffset?a.pageXOffset:(a.document.documentElement||a.document.body.parentNode||a.document.body).scrollLeft,scrollY:void 0!==a.pageYOffset?a.pageYOffset:(a.document.documentElement||a.document.body.parentNode||a.document.body).scrollTop}}}}()},{"../configuration/config":26,"../template/directive_finder":71,jquery:"jquery"}],41:[function(a,b,c){var d,e,f;e=a("../configuration/config"),f=e.css,b.exports=d=function(){function a(a,b){var c;this.page=a,this.modes=["direct","longpress","move"],c={preventDefault:!1,onDragStart:void 0,scrollArea:50,longpress:{showIndicator:!0,delay:400,tolerance:3},move:{distance:0}},this.defaultConfig=$.extend(!0,c,b),this.startPoint=void 0,this.dragHandler=void 0,this.initialized=!1,this.started=!1}return a.prototype.setOptions=function(a){return this.options=$.extend(!0,{},this.defaultConfig,a),this.mode=null!=a.direct?"direct":null!=a.longpress?"longpress":null!=a.move?"move":"longpress"},a.prototype.setDragHandler=function(a){return this.dragHandler=a,this.dragHandler.page=this.page},a.prototype.init=function(a,b,c){return this.reset(),this.initialized=!0,this.setOptions(c),this.setDragHandler(a),this.startPoint=this.getEventPosition(b),this.addStopListeners(b),this.addMoveListeners(b),"longpress"===this.mode?(this.addLongpressIndicator(this.startPoint),this.timeout=setTimeout(function(a){return function(){return a.removeLongpressIndicator(),a.start(b)}}(this),this.options.longpress.delay)):"direct"===this.mode&&this.start(b),this.options.preventDefault?b.preventDefault():void 0},a.prototype.move=function(a){var b;if(b=this.getEventPosition(a),"longpress"===this.mode){if(this.distance(b,this.startPoint)>this.options.longpress.tolerance)return this.reset()}else if("move"===this.mode&&this.distance(b,this.startPoint)>this.options.move.distance)return this.start(a)},a.prototype.start=function(a){var b;return b=this.getEventPosition(a),this.started=!0,this.addBlocker(),this.page.$body.addClass(f.preventSelection),this.dragHandler.start(b)},a.prototype.drop=function(a){return this.started&&this.dragHandler.drop(a),$.isFunction(this.options.onDrop)&&this.options.onDrop(a,this.dragHandler),this.reset()},a.prototype.cancel=function(){return this.reset()},a.prototype.reset=function(){return this.started&&(this.started=!1,this.page.$body.removeClass(f.preventSelection)),this.initialized?(this.initialized=!1,this.startPoint=void 0,this.dragHandler.reset(),this.dragHandler=void 0,null!=this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.page.$document.off(".livingdocs-drag"),this.removeLongpressIndicator(),this.removeBlocker()):void 0},a.prototype.addBlocker=function(){var a;return a=$("<div class='"+f.dragBlocker+"'>").attr("style","position: absolute; top: 0; bottom: 0; left: 0; right: 0;"),this.page.$body.append(a)},a.prototype.removeBlocker=function(){return this.page.$body.find("."+f.dragBlocker).remove()},a.prototype.addLongpressIndicator=function(a){var b,c,d;return c=a.pageX,d=a.pageY,this.options.longpress.showIndicator?(b=$('<div class="'+f.longpressIndicator+'"><div></div></div>'),b.css({left:c,top:d}),this.page.$body.append(b)):void 0},a.prototype.removeLongpressIndicator=function(){return this.page.$body.find("."+f.longpressIndicator).remove()},a.prototype.addStopListeners=function(a){var b;return b="touchstart"===a.type?"touchend.livingdocs-drag touchcancel.livingdocs-drag touchleave.livingdocs-drag":"dragenter"===a.type||"dragbetterenter"===a.type?"drop.livingdocs-drag dragend.livingdocs-drag":"mouseup.livingdocs-drag",this.page.$document.on(b,function(a){return function(b){return a.drop(b)}}(this))},a.prototype.addMoveListeners=function(a){return"touchstart"===a.type?this.page.$document.on("touchmove.livingdocs-drag",function(a){return function(b){return b.preventDefault(),a.started?a.dragHandler.move(a.getEventPosition(b)):a.move(b)}}(this)):"dragenter"===a.type||"dragbetterenter"===a.type?this.page.$document.on("dragover.livingdocs-drag",function(a){return function(b){return a.started?a.dragHandler.move(a.getEventPosition(b)):a.move(b)}}(this)):this.page.$document.on("mousemove.livingdocs-drag",function(a){return function(b){return a.started?a.dragHandler.move(a.getEventPosition(b)):a.move(b)}}(this))},a.prototype.getEventPosition=function(a){return"touchstart"===a.type||"touchmove"===a.type?a=a.originalEvent.changedTouches[0]:"dragover"===a.type&&(a=a.originalEvent),{clientX:a.clientX,clientY:a.clientY,pageX:a.pageX,pageY:a.pageY}},a.prototype.distance=function(a,b){var c,d;return a&&b?(c=a.pageX-b.pageX,d=a.pageY-b.pageY,Math.sqrt(c*c+d*d)):void 0},a}()},{"../configuration/config":26}],42:[function(a,b,c){var d,e,f,g=[].slice;f=a("./dom"),e=a("../configuration/config"),b.exports=d=function(){function a(a){this.page=a,this.editable=new Editable({window:this.page.window,browserSpellcheck:e.editable.browserSpellcheck,mouseMoveSelectionChanges:e.editable.mouseMoveSelectionChanges}),this.editableAttr=e.directives.editable.renderedAttr,this.selection=$.Callbacks(),this.editable.focus(this.withContext(this.focus)).blur(this.withContext(this.blur)).insert(this.withContext(this.insert)).paste(this.withContext(this.paste)).merge(this.withContext(this.merge)).split(this.withContext(this.split)).selection(this.withContext(this.selectionChanged)).newline(this.withContext(this.newline)).change(this.withContext(this.change))}return a.prototype.add=function(a){return this.editable.add(a)},a.prototype.disableAll=function(){return this.editable.suspend()},a.prototype.reenableAll=function(){return this.editable["continue"]()},a.prototype.withContext=function(a){return function(b){return function(){var c,d,e,h;return e=arguments[0],c=2<=arguments.length?g.call(arguments,1):[],h=f.findComponentView(e),d=e.getAttribute(b.editableAttr),c.unshift(h,d),a.apply(b,c)}}(this)},a.prototype.extractContent=function(a){var b;return b=this.editable.getContent(a),e.singleLineBreak.test(b)||""===b?void 0:b},a.prototype.updateModel=function(a,b,c){var d;return d=this.extractContent(c),a.model.set(b,d)},a.prototype.focus=function(a,b){var c;return a.focusEditable(b),c=a.getDirectiveElement(b),this.page.focus.editableFocused(c,a),!0},a.prototype.blur=function(a,b){var c;return this.clearChangeTimeout(),c=a.getDirectiveElement(b),this.updateModel(a,b,c),a.blurEditable(b),this.page.focus.editableBlurred(c,a),!0},a.prototype.insert=function(a,b,c,d){var e,f,g;return f=this.page.design.defaultParagraph,this.hasSingleEditable(a)&&null!=f&&(e=f.createModel(),g="before"===c?(a.model.before(e),a.prev()):(a.model.after(e),a.next()),g&&"after"===c&&g.focus()),!1},a.prototype.paste=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o;if(h=c[0],d.insertBefore(h),c.length<=1)d.setVisibleSelection();else{for(g=this.page.design.defaultParagraph,i=null!=(n=g.directives.editable)?n[0]:void 0,f=a.model,k=j=0,l=c.length;l>j;k=++j)e=c[k],0!==k&&(m=g.createModel(),m.set(i.name,e),f.after(m),f=m);a=f.getMainView(),null!=a&&(o=a.directives.get(i.name),d=this.editable.createCursorAtEnd(o.elem),d.setVisibleSelection())}return!1},a.prototype.merge=function(a,b,c,d){var e,f,g,h;return this.hasSingleEditable(a)&&(f="before"===c?a.prev():a.next(),f&&f.template===a.template&&(h=a.getDirectiveElement(b),g=f.getDirectiveElement(b),e=this.editable.getContent(h),d="before"===c?this.editable.appendTo(g,e):this.editable.prependTo(g,e),a.model.remove(),d.setVisibleSelection(),this.updateModel(f,b,g))),!1},a.prototype.split=function(a,b,c,d,e){var f,g;return this.hasSingleEditable(a)&&(f=a.template.createModel(),f.set(b,this.extractContent(d)),a.model.after(f),null!=(g=a.next())&&g.focus(),a.model.set(b,this.extractContent(c))),!1},a.prototype.selectionChanged=function(a,b,c){var d;return d=a.getDirectiveElement(b),this.selection.fire(a,d,c)},a.prototype.newline=function(a,b,c){return e.editable.allowNewline?!0:!1},a.prototype.change=function(a,b){return this.clearChangeTimeout(),e.editable.changeDelay!==!1?this.changeTimeout=setTimeout(function(c){return function(){var d;return d=a.getDirectiveElement(b),c.updateModel(a,b,d),c.changeTimeout=void 0}}(this),e.editable.changeDelay):void 0},a.prototype.clearChangeTimeout=function(){return null!=this.changeTimeout?(clearTimeout(this.changeTimeout),this.changeTimeout=void 0):void 0},a.prototype.hasSingleEditable=function(a){return 1===a.directives.length&&"editable"===a.directives[0].type},a}()},{"../configuration/config":26,"./dom":40}],43:[function(a,b,c){var d,e,f;f=a("./dom"),d=a("./container_event"),b.exports=e=function(){function a(){this.editableNode=void 0,this.componentView=void 0,this.componentFocus=$.Callbacks(),this.componentBlur=$.Callbacks(),this.containerFocus=$.Callbacks(),this.containerBlur=$.Callbacks()}return a.prototype.setFocus=function(a,b){return b!==this.editableNode&&(this.resetEditable(),this.editableNode=b),a!==this.componentView&&(this.resetComponentView(),a)?(this.componentView=a,this.componentFocus.fire(this.componentView),this.fireContainerEvent({view:this.componentView,focus:!0})):void 0},a.prototype.editableFocused=function(a,b){return this.editableNode!==a?(b||(b=f.findComponentView(a)),this.setFocus(b,a)):void 0},a.prototype.editableBlurred=function(a){
return this.editableNode===a?this.setFocus(this.componentView,void 0):void 0},a.prototype.componentFocused=function(a){return this.componentView!==a?this.setFocus(a,void 0):void 0},a.prototype.blur=function(){return this.setFocus(void 0,void 0)},a.prototype.resetEditable=function(){return this.editableNode?this.editableNode=void 0:void 0},a.prototype.resetComponentView=function(){var a;return this.componentView?(a=this.componentView,this.componentView=void 0,this.componentBlur.fire(a),this.fireContainerEvent({view:a,blur:!0})):void 0},a.prototype.fireContainerEvent=function(a){var b,c,e,f,g;return g=a.view,f=a.focus,b=a.blur,e=new d({target:g,focus:f,blur:b}),c=g.model,c.parentContainers(function(a){return function(b){return a[e.type].fire(b,e)}}(this))},a}()},{"./container_event":39,"./dom":40}],44:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=function(a,b){function c(){this.constructor=a}for(var d in b)t.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},t={}.hasOwnProperty;o=a("./modules/logging/assert"),m=a("./rendering_container/rendering_container"),k=a("./rendering_container/page"),h=a("./rendering_container/interactive_page"),l=a("./rendering/renderer"),n=a("./rendering/view"),f=a("wolfy87-eventemitter"),p=a("./configuration/config"),r=a("./interaction/dom"),q=a("./design/design_cache"),d=a("./component_tree/component_tree"),e=a("./rendering/dependencies"),g=a("./component_tree/field_extractor"),j=a("./configuration/metadata_config"),b.exports=i=function(a){function b(a){this.componentTree=a.componentTree,this.layoutName=a.layoutName,this.model=this.componentTree,this.interactiveView=void 0,this.readOnlyViews=[],this.design=this.componentTree.design,this.dependencies=new e({componentTree:this.componentTree}),this.metadataConfig=new j(this.design.metadata),this.fieldExtractor=new g(this.componentTree,this.metadataConfig),this.forwardComponentTreeEvents()}return s(b,a),b.create=function(a){var c,e,f,g,h,i;return e=a.data,g=a.designName,h=a.layoutName,c=a.componentTree,c=null!=e?(g=null!=(i=e.design)?i.name:void 0,o(null!=g,"Error creating livingdoc: No design is specified."),f=q.get(g),new d({content:e,design:f})):null!=g?(f=q.get(g),new d({design:f})):c,(null!=e?e.layout:void 0)&&(h=e.layout),new b({componentTree:c,layoutName:h})},b.prototype.getDropTarget=function(a){var b,c,d,e,f,g,h;return g=a.event,e=g.target.ownerDocument,b=g.clientX,c=g.clientY,f=e.elementFromPoint(b,c),null!=f?(d={left:g.pageX,top:g.pageY},h=r.dropTarget(f,d)):void 0},b.prototype.forwardComponentTreeEvents=function(){return this.componentTree.changed.add(function(a){return function(){return a.emit("change",arguments)}}(this))},b.prototype.createView=function(a){var b,c,d,e,f,g,h,i;return b=a.host,d=a.interactive,f=a.loadResources,i=a.wrapper,e=a.layoutName,c=a.iframe,h=this.getWrapper({wrapper:i,layoutName:e,host:b}),null==c&&(c=!0),g=new n({livingdoc:this,parent:$(b),isInteractive:d,loadResources:f,wrapper:h}),this.addView(g),g.create({renderInIframe:c})},b.prototype.appendTo=function(a){return null==a&&(a={}),a.iframe=!1,this.createView(a)},b.prototype.createComponent=function(){return this.componentTree.createComponent.apply(this.componentTree,arguments)},b.prototype.getWrapper=function(a){var b,c,d,e;return e=a.wrapper,c=a.layoutName,b=a.host,null!=e?e:(null==c&&(c=this.layoutName),e=null!=(d=this.design.getLayout(c))?d.wrapper:void 0,null==e&&(e=this.extractWrapper(b)),e)},b.prototype.extractWrapper=function(a){var b,c;return b=$(a).first(),1===b.find("."+p.css.section).length&&(c=$(b.html())),b.html(""),c},b.prototype.addView=function(a){return a.isInteractive?(o(null==this.interactiveView,"Error creating interactive view: A Livingdoc can have only one interactive view"),this.interactiveView=a,a.whenReady.then(function(b){return function(c){var d,e;return d=c.iframe,e=c.renderer,b.componentTree.setMainView(a)}}(this))):this.readOnlyViews.push(a)},b.prototype.addJsDependency=function(a){return this.dependencies.addJs(a)},b.prototype.addCssDependency=function(a){return this.dependencies.addCss(a)},b.prototype.hasDependencies=function(){var a,b;return(null!=(a=this.dependencies)?a.hasJs():void 0)||(null!=(b=this.dependencies)?b.hasCss():void 0)},b.prototype.toHtml=function(a){var b;return b=(null!=a?a:{}).excludeComponents,new l({componentTree:this.componentTree,renderingContainer:new m,excludeComponents:b}).html()},b.prototype.serialize=function(){var a;return a=this.componentTree.serialize(),a.layout=this.layoutName,a},b.prototype.toJson=function(a){var b,c,d;return b=this.serialize(),null!=a?(d=null,c=2,JSON.stringify(b,d,c)):JSON.stringify(b)},b.prototype.printModel=function(){return this.componentTree.print()},b.dom=r,b}(f)},{"./component_tree/component_tree":19,"./component_tree/field_extractor":21,"./configuration/config":26,"./configuration/metadata_config":27,"./design/design_cache":30,"./interaction/dom":40,"./modules/logging/assert":49,"./rendering/dependencies":56,"./rendering/renderer":59,"./rendering/view":60,"./rendering_container/interactive_page":64,"./rendering_container/page":66,"./rendering_container/rendering_container":67,"wolfy87-eventemitter":11}],45:[function(a,b,c){var d=[].slice;b.exports=function(){return{callOnce:function(a,b){var c;return c=function(){var e;return e=1<=arguments.length?d.call(arguments,0):[],a.remove(c),b.apply(this,e)},a.add(c),c}}}()},{}],46:[function(a,b,c){var d;d=a("jquery"),b.exports=function(){return{htmlPointerEvents:function(){var a;return a=d("<x>")[0],a.style.cssText="pointer-events:auto","auto"===a.style.pointerEvents}}}()},{jquery:"jquery"}],47:[function(a,b,c){var d,e;d=a("./feature_detects"),e={},b.exports=function(a){var b;return void 0===(b=e[a])?e[a]=Boolean(d[a]()):b}},{"./feature_detects":46}],48:[function(a,b,c){b.exports=function(){var a,b;return a=b=void 0,{next:function(c){var d;return null==c&&(c="doc"),d=Date.now().toString(32),b===d?a+=1:(a=0,b=d),c+"-"+d+a}}}()},{}],49:[function(a,b,c){var d,e;e=a("./log"),b.exports=d=function(a,b){return a?void 0:e.error(b)}},{"./log":50}],50:[function(a,b,c){var d,e=[].slice,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;b.exports=d=function(){var a;return a=1<=arguments.length?e.call(arguments,0):[],null!=window.console?(a.length&&"trace"===a[a.length-1]&&(a.pop(),null!=window.console.trace&&window.console.trace()),void window.console.log.apply(window.console,a)):void 0},function(){var a,b;return a=function(a){function b(a){b.__super__.constructor.apply(this,arguments),this.message=a,this.thrownByLivingdocs=!0}return f(b,a),b}(Error),b=function(b,c){if(null==c&&(c="error"),"undefined"!=typeof _rollbar&&null!==_rollbar)_rollbar.push(new Error(b),function(){var a;return"critical"!==c&&"error"!==c||null==(null!=(a=window.console)?a.error:void 0)?d.call(void 0,b):window.console.error.call(window.console,b)});else{if("critical"===c||"error"===c)throw new a(b);d.call(void 0,b)}return void 0},d.debug=function(a){return d.debugDisabled?void 0:b(a,"debug")},d.warn=function(a){return d.warningsDisabled?void 0:b(a,"warning")},d.error=function(a){return b(a,"error")}}()},{}],51:[function(a,b,c){var d;b.exports=d=function(){function a(){this.obj={},this.length=0}return a.prototype.push=function(a,b){return this.obj[a]=b,this[this.length]=b,this.length+=1},a.prototype.get=function(a){return this.obj[a]},a.prototype.each=function(a){var b,c,d,e;for(d=[],b=0,c=this.length;c>b;b++)e=this[b],d.push(a(e));return d},a.prototype.toArray=function(){var a,b,c,d;for(c=[],a=0,b=this.length;b>a;a++)d=this[a],c.push(d);return c},a}()},{}],52:[function(a,b,c){var d,e;e=a("../modules/logging/assert"),b.exports=d=function(){function a(){this.count=0,this.started=!1,this.wasFired=!1,this.callbacks=[]}return a.prototype.addCallback=function(a){return this.wasFired?a():this.callbacks.push(a)},a.prototype.isReady=function(){return this.wasFired},a.prototype.start=function(){return e(!this.started,"Unable to start Semaphore once started."),this.started=!0,this.fireIfReady()},a.prototype.increment=function(a){return null==a&&(a=1),e(!this.wasFired,"Unable to increment count once Semaphore is fired."),this.count+=a},a.prototype.decrement=function(a){return null==a&&(a=1),e(this.count>0,"Unable to decrement count resulting in negative count."),this.count-=a,this.fireIfReady()},a.prototype.wait=function(a){return this.increment(a),function(b){return function(){return b.decrement(a)}}(this)},a.prototype.fireIfReady=function(){var a,b,c,d,e;if(0===this.count&&this.started===!0){for(this.wasFired=!0,d=this.callbacks,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a());return e}},a}()},{"../modules/logging/assert":49}],53:[function(a,b,c){b.exports=function(){return{isEmpty:function(a){var b;if(null==a)return!0;for(b in a)if(a.hasOwnProperty(b))return!1;return!0},flatCopy:function(a){var b,c,d;b=void 0;for(c in a)d=a[c],b||(b={}),b[c]=d;return b}}}()},{}],54:[function(a,b,c){var d;d=a("jquery"),b.exports=function(){return{humanize:function(a){var b;return b=d.trim(a).replace(/([a-z\d])([A-Z]+)/g,"$1 $2").toLowerCase(),this.titleize(b)},capitalize:function(a){return a=null==a?"":String(a),a.charAt(0).toUpperCase()+a.slice(1)},titleize:function(a){return null==a?"":String(a).replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()})},snakeCase:function(a){return d.trim(a).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},prefix:function(a,b){return 0===b.indexOf(a)?b:""+a+b},readableJson:function(a){return JSON.stringify(a,null,2)},camelize:function(a){return d.trim(a).replace(/[-_\s]+(.)?/g,function(a,b){return b.toUpperCase()})},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},extractTextFromHtml:function(a){var b;return b=d("<div>")[0],b.innerHTML=a,b.textContent}}}()},{jquery:"jquery"}],55:[function(a,b,c){var d,e,f,g,h,i,j,k;d=a("jquery"),h=a("../configuration/config"),i=h.css,g=h.attr,f=a("../template/directive_iterator"),k=a("../modules/eventing"),j=a("../interaction/dom"),b.exports=e=function(){function a(a){this.model=a.model,this.$html=a.$html,this.directives=a.directives,this.isReadOnly=a.isReadOnly,this.renderer=void 0,this.$elem=this.$html,this.template=this.model.template,this.isAttachedToDom=!1,this.wasAttachedToDom=d.Callbacks(),this.decorateMarkup(),this.render()}return a.prototype.decorateMarkup=function(){return this.isReadOnly?void 0:this.$html.data("componentView",this).addClass(i.component).attr(g.template,this.template.identifier)},a.prototype.setRenderer=function(a){return this.renderer=a},a.prototype.removeRenderer=function(){return this.renderer=void 0},a.prototype.viewForModel=function(a){var b;return null!=a&&null!=(b=this.renderer)?b.getComponentViewById(a.id):void 0},a.prototype.recreateHtml=function(){var a;return this.isAttachedToDom=!1,a=this.model.template.createViewHtml(this.model),this.$elem=a.$elem,this.directives=a.directives,this.$html=this.$elem,this.decorateMarkup(),this.render()},a.prototype.refresh=function(){return this.renderer.refreshComponent(this.model)},a.prototype.render=function(a){return this.updateContent(),this.updateHtml()},a.prototype.updateContent=function(a){return a?this.set(a,this.model.content[a]):this.setAll(),this.hasFocus()||this.displayOptionals(),this.stripHtmlIfReadOnly()},a.prototype.updateHtml=function(){var a,b,c;b=this.model.styles;for(a in b)c=b[a],this.setStyle(a,c);return this.stripHtmlIfReadOnly()},a.prototype.displayOptionals=function(){return this.directives.each(function(a){return function(b){var c;return b.optional?(c=d(b.elem),a.model.isEmpty(b.name)?c.css("display","none"):c.css("display","")):void 0}}(this))},a.prototype.showOptionals=function(){return this.directives.each(function(a){return function(a){return a.optional?h.animations.optionals.show(d(a.elem)):void 0}}(this))},a.prototype.hideEmptyOptionals=function(){return this.directives.each(function(a){return function(b){return b.optional&&a.model.isEmpty(b.name)?h.animations.optionals.hide(d(b.elem)):void 0}}(this))},a.prototype.afterFocused=function(){return this.$html.addClass(i.componentHighlight),this.showOptionals()},a.prototype.afterBlurred=function(){return this.$html.removeClass(i.componentHighlight),this.hideEmptyOptionals()},a.prototype.focus=function(a){var b,c;return b=a?this.directives.get(a):null!=(c=this.directives.editable)?c[0]:void 0,d(null!=b?b.elem:void 0).focus()},a.prototype.hasFocus=function(){return this.$html.hasClass(i.componentHighlight)},a.prototype.getBoundingClientRect=function(){return this.$html[0].getBoundingClientRect()},a.prototype.getAbsoluteBoundingClientRect=function(){return j.getAbsoluteBoundingClientRect(this.$html[0])},a.prototype.setAll=function(){var a,b,c;b=this.model.content;for(a in b)c=b[a],this.set(a,c);return void 0},a.prototype.set=function(a,b){var c;switch(c=this.model.directives.get(a),c.type){case"editable":return this.setEditable(a,b);case"image":return null!=c.base64Image?this.setImage(a,c.base64Image):this.setImage(a,c.getImageUrl());case"html":return this.setHtml(a,b);case"link":return this.setLink(a,b)}},a.prototype.get=function(a){var b;switch(b=this.directives.get(a),b.type){case"editable":return this.getEditable(a);case"image":return this.getImage(a);case"html":return this.getHtml(a);case"link":return this.getLink(a)}},a.prototype.getEditable=function(a){var b;return b=this.directives.$getElem(a),b.html()},a.prototype.setEditable=function(a,b){var c,d,e,f;return c=this.directives.$getElem(a),d=c[0],f=d.ownerDocument,(e=f.activeElement===d)?void 0:(c.toggleClass(i.noPlaceholder,Boolean(b)),c.attr(g.placeholder,this.template.defaults[a]),c.html(b||""))},a.prototype.focusEditable=function(a){var b;return b=this.directives.$getElem(a),b.addClass(i.noPlaceholder)},a.prototype.blurEditable=function(a){var b;return b=this.directives.$getElem(a),this.model.isEmpty(a)?b.removeClass(i.noPlaceholder):void 0},a.prototype.getHtml=function(a){var b;return b=this.directives.$getElem(a),b.html()},a.prototype.setHtml=function(a,b){var c;return c=this.directives.$getElem(a),c.html(b||""),b?b&&!this.isReadOnly&&this.blockInteraction(c):c.html(this.template.defaults[a]),this.directivesToReset||(this.directivesToReset={}),this.directivesToReset[a]=a},a.prototype.setLink=function(a,b){var c;return c=this.directives.$getElem(a),b?c.attr("href",b):c.removeAttr("href")},a.prototype.getLink=function(a){var b;return b=this.directives.$getElem(a),b.attr("href")},a.prototype.getDirectiveElement=function(a){var b;return null!=(b=this.directives.get(a))?b.elem:void 0},a.prototype.resetDirectives=function(){var a,b,c;c=[];for(b in this.directivesToReset)a=this.directives.$getElem(b),c.push(a.find("iframe").length?this.set(b,this.model.content[b]):void 0);return c},a.prototype.getImage=function(a){var b;return b=this.directives.$getElem(a),b.attr("src")},a.prototype.setImage=function(a,b){var c,e,f;return c=this.directives.$getElem(a),b?(this.cancelDelayed(a),e=this.model.directives.get(a).getImageService(),e.set(c,b),c.removeClass(h.css.emptyImage)):(f=d.proxy(this.setPlaceholderImage,this,c,a),this.delayUntilAttached(a,f))},a.prototype.setPlaceholderImage=function(a,b){var c;return a.addClass(h.css.emptyImage),c=this.model.directives.get(b).getImageService(),c.set(a,h.imagePlaceholder)},a.prototype.setStyle=function(a,b){var c,d,e,f,g;if(c=this.template.styles[a].cssClassChanges(b),c.remove)for(f=c.remove,d=0,e=f.length;e>d;d++)g=f[d],this.$html.removeClass(g);return this.$html.addClass(c.add)},a.prototype.disableTabbing=function(a){return setTimeout(function(b){return function(){return a.find("iframe").attr("tabindex","-1")}}(this),400)},a.prototype.blockInteraction=function(a){var b;return this.ensureRelativePosition(a),b=d("<div class='"+i.interactionBlocker+"'>").attr("style","position: absolute; top: 0; bottom: 0; left: 0; right: 0;"),a.append(b),this.disableTabbing(a)},a.prototype.ensureRelativePosition=function(a){var b;return b=a.css("position"),"absolute"!==b&&"fixed"!==b&&"relative"!==b?a.css("position","relative"):void 0},a.prototype.get$container=function(){return d(j.findContainer(this.$html[0]).node)},a.prototype.delayUntilAttached=function(a,b){return this.isAttachedToDom?b():(this.cancelDelayed(a),this.delayed||(this.delayed={}),this.delayed[a]=k.callOnce(this.wasAttachedToDom,function(c){return function(){return c.delayed[a]=void 0,b()}}(this)))},a.prototype.cancelDelayed=function(a){var b;return(null!=(b=this.delayed)?b[a]:void 0)?(this.wasAttachedToDom.remove(this.delayed[a]),this.delayed[a]=void 0):void 0},a.prototype.stripHtmlIfReadOnly=function(){var a,b,c;if(this.isReadOnly){for(b=new f(this.$html[0]),c=[];a=b.nextElement();)this.stripDocClasses(a),this.stripDocAttributes(a),c.push(this.stripEmptyAttributes(a));return c}},a.prototype.stripDocClasses=function(a){var b,c,e,f,g,h;for(b=d(a),g=a.className.split(/\s+/),h=[],c=0,f=g.length;f>c;c++)e=g[c],h.push(/doc\-.*/i.test(e)?b.removeClass(e):void 0);return h},a.prototype.stripDocAttributes=function(a){var b,c,e,f,g,h,i;for(b=d(a),h=Array.prototype.slice.apply(a.attributes),i=[],e=0,f=h.length;f>e;e++)c=h[e],g=c.name,i.push(/data\-doc\-.*/i.test(g)?b.removeAttr(g):void 0);return i},a.prototype.stripEmptyAttributes=function(a){var b,c,e,f,g,h,i,j,k;for(b=d(a),k=["style","class"],i=Array.prototype.slice.apply(a.attributes),j=[],e=0,h=i.length;h>e;e++)c=i[e],g=k.indexOf(c.name)>=0,f=""===c.value.trim(),j.push(g&&f?b.removeAttr(c.name):void 0);return j},a.prototype.setAttachedToDom=function(a){return a!==this.isAttachedToDom?(this.isAttachedToDom=a,a?(this.resetDirectives(),this.wasAttachedToDom.fire()):void 0):void 0},a.prototype.getOwnerWindow=function(){return this.$elem[0].ownerDocument.defaultView},a.prototype.next=function(){return this.viewForModel(this.model.next)},a.prototype.prev=function(){return this.previous()},a.prototype.previous=function(){return this.viewForModel(this.model.previous)},a.prototype.parent=function(){return this.viewForModel(this.model.getParent())},a}(),["parents","children","childrenAndSelf","descendants","descendantsAndSelf"].forEach(function(a){return e.prototype[a]=function(b){return this.model[a](function(a){return function(c){return b(a.viewForModel(c))}}(this))}})},{"../configuration/config":26,"../interaction/dom":40,"../modules/eventing":45,"../template/directive_iterator":72,jquery:"jquery"}],56:[function(a,b,c){var d,e,f,g,h,i,j=function(a,b){return function(){return a.apply(b,arguments)}};d=a("jquery"),i=a("../modules/logging/log"),g=a("../modules/logging/assert"),f=a("./dependency"),h=a("./dependencies_to_html"),b.exports=e=function(){function a(a){this.componentTree=(null!=a?a:{}).componentTree,this.onComponentRemoved=j(this.onComponentRemoved,this),this.js=[],this.css=[],this.namespaces={},this.jsWaitlist=[],this.dependenciesAdded=d.Callbacks(),this.dependencyToExecute=d.Callbacks(),this.codeToExecute=d.Callbacks(),this.dependencyRemoved=d.Callbacks(),null!=this.componentTree&&this.componentTree.componentRemoved.add(this.onComponentRemoved)}return a.prototype.add=function(a){var b,c;return this.convertToAbsolutePaths(a),b=new f(a),(c=this.getExisting(b))?null!=a.component?c.addComponent(a.component):void 0:this.addDependency(b)},a.prototype.addJs=function(a){return a.type="js",this.add(a)},a.prototype.addCss=function(a){return a.type="css",this.add(a)},a.prototype.executeJs=function(a){return a.isExecuteOnly=!0,this.addJs(a)},a.prototype.executeCode=function(a){return this.codeToExecute.fire(a)},a.prototype.convertToAbsolutePaths=function(a){var b;if(a.src)return b=a.src,this.isAbsoluteUrl(b)?void 0:(g(a.basePath,"Dependencies: relative urls are not allowed: "+b),b=b.replace(/^[\.\/]*/,""),a.src=a.basePath.replace(/\/$/,"")+"/"+b)},a.prototype.isAbsoluteUrl=function(a){return/(^\/\/|[a-z]*:\/\/)/.test(a)||/^\//.test(a)},a.prototype.addDependency=function(a){return a.isExecuteOnly?this.dependencyToExecute.fire(a):(a.namespace&&this.addToNamespace(a),a.isJs()?(this.js.push(a),this.delayedDependency(a)):(this.css.push(a),this.dependenciesAdded.fire(void 0,[a]))),a},a.prototype.delayedDependency=function(a){return this.jsWaitlist.push(a),1===this.jsWaitlist.length?setTimeout(function(a){return function(){return a.dependenciesAdded.fire(a.jsWaitlist,void 0),a.jsWaitlist=[]}}(this),0):void 0},a.prototype.addToNamespace=function(a){var b,c,d;return a.namespace?(null==(b=this.namespaces)[c=a.namespace]&&(b[c]=[]),d=this.namespaces[a.namespace],d.push(a)):void 0},a.prototype.removeFromNamespace=function(a){var b,c;return(c=this.getNamespace(a.namespace))&&(b=c.indexOf(a),b>-1)?c.splice(b,1):void 0},a.prototype.getNamespaces=function(){var a,b,c,d;c=this.namespaces,d=[];for(b in c)a=c[b],d.push(b);return d},a.prototype.getNamespace=function(a){var b;return b=this.namespaces[a],(null!=b?b.length:void 0)?b:void 0},a.prototype.getExisting=function(a){var b,c,d,e;for(b=a.isJs()?this.js:this.css,d=0,e=b.length;e>d;d++)if(c=b[d],c.isSameAs(a))return c;return void 0},a.prototype.hasCss=function(){return this.css.length>0},a.prototype.hasJs=function(){return this.js.length>0},a.prototype.onComponentRemoved=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;for(m=[],j=this.js,c=0,f=j.length;f>c;c++)b=j[c],i=b.removeComponent(a),i||m.push(b);for(k=this.css,d=0,g=k.length;g>d;d++)b=k[d],i=b.removeComponent(a),i||m.push(b);for(l=[],e=0,h=m.length;h>e;e++)b=m[e],l.push(this.removeDependency(b));return l},a.prototype.removeDependency=function(a){var b,c;return a.namespace&&this.removeFromNamespace(a),b=a.isJs()?this.js:this.css,c=b.indexOf(a),c>-1&&b.splice(c,1),this.dependencyRemoved.fire(a)},a.prototype.serialize=function(){var a,b,c,d,e,f,g,h;for(a={},g=this.js,c=0,e=g.length;e>c;c++)b=g[c],null==a.js&&(a.js=[]),a.js.push(b.serialize());for(h=this.css,d=0,f=h.length;f>d;d++)b=h[d],null==a.css&&(a.css=[]),a.css.push(b.serialize());return a},a.prototype.deserialize=function(a){var b,c,d,e,f,g,h,i,j;if(null!=a){for(h=a.js||[],c=0,e=h.length;e>c;c++)b=h[c],g={type:"js",src:b.src,code:b.code,namespace:b.namespace,library:b.library},this.addDeserialzedObj(g,b);for(i=a.css||[],j=[],d=0,f=i.length;f>d;d++)b=i[d],g={type:"css",src:b.src,code:b.code,namespace:b.namespace,library:b.library},j.push(this.addDeserialzedObj(g,b));return j}},a.prototype.addDeserialzedObj=function(a,b){var c,d,e,f,g,h,j,k,l,m,n;if(null!=(l=b.componentIds)?l.length:void 0){for(d=[],m=b.componentIds,f=0,j=m.length;j>f;f++)g=m[f],c=this.componentTree.findById(g),null!=c&&d.push(c);if(d.length){for(e=this.add(a),n=[],h=0,k=d.length;k>h;h++)c=d[h],n.push(e.addComponent(c));return n}return i.warn("Dropped dependency: could not find components that depend on it",b)}return this.add(a)},a.prototype.printJs=function(){return h.printJs(this)},a.prototype.printCss=function(){return h.printCss(this)},a}()},{"../modules/logging/assert":49,"../modules/logging/log":50,"./dependencies_to_html":57,"./dependency":58,jquery:"jquery"}],57:[function(a,b,c){var d,e;e=a("../rendering_container/js_loader"),d=a("../rendering_container/css_loader"),b.exports={printJs:function(a){var b,c,d,e,f;for(c="",f=a.js,d=0,e=f.length;e>d;d++)b=f[d],c+=b.inline?this.printInlineScript({codeBlock:b.code}):this.printScriptTag({src:b.src}),c+="\n";return c},printCss:function(a){var b,c,d,e,f;for(c="",f=a.css,d=0,e=f.length;e>d;d++)b=f[d],c+=b.inline?this.printInlineCss({styles:b.code}):this.printCssLink({src:b.src}),c+="\n";return c},printScriptTag:function(a){var b;return b=a.src,'<script src="'+b+'"></script>'},printInlineScript:function(a){var b;return b=a.codeBlock,b=e.prototype.prepareInlineCode(b),"<script> "+b+" </script>"},printCssLink:function(a){var b,c;return c=a.src,b=a.head,null==b&&(b=!0),b?'<link rel="stylesheet" type="text/css" href="'+c+'">':'<link rel="stylesheet" type="text/css" href="'+c+'">'},printInlineCss:function(a){var b;return b=a.styles,b=d.prototype.prepareInlineStyles(b),"<style> "+b+" </style>"},printComment:function(a){return"<!-- "+a+" -->"}}},{"../rendering_container/css_loader":62,"../rendering_container/js_loader":65}],58:[function(a,b,c){var d,e;e=a("../modules/logging/assert"),b.exports=d=function(){function a(a){var b,c;this.type=a.type,this.src=a.src,this.code=a.code,this.namespace=a.namespace,this.library=a.library,this.isExecuteOnly=a.isExecuteOnly,b=a.component,e(this.src||this.code,'Dependency: No "src" or "code" param provided'),e(!(this.src&&this.code),'Dependency: Only provide one of "src" or "code" params'),e(this.type,"Dependency: Param type must be specified"),e("js"===(c=this.type)||"css"===c,"Dependency: Unrecognized type: "+this.type),null!=this.code&&(this.inline=!0),this.components={},this.componentCount=0,null!=b&&this.addComponent(b)}return a.prototype.isJs=function(){return"js"===this.type},a.prototype.isCss=function(){return"css"===this.type},a.prototype.hasComponent=function(a){return null!=this.components[a.id]},a.prototype.addComponent=function(a){return this.hasComponent(a)?void 0:(this.componentCount+=1,this.components[a.id]=!0)},a.prototype.removeComponent=function(a){return this.hasComponent(a)?(this.componentCount-=1,this.components[a.id]=void 0,0!==this.componentCount):!0},a.prototype.isSameAs=function(a){return this.type!==a.type?!1:this.namespace!==a.namespace?!1:a.src?this.src===a.src:this.code===a.code},a.prototype.serialize=function(){var a,b,c,d,f,g;for(e(!this.isExecuteOnly,"engine//dependency.coffee: Cannot serialize a temporary dependency"),f={},g=["src","code","inline","library","namespace"],b=0,d=g.length;d>b;b++)c=g[b],null!=this[c]&&(f[c]=this[c]);for(a in this.components)null==f.componentIds&&(f.componentIds=[]),f.componentIds.push(a);return f},a}()},{"../modules/logging/assert":49}],59:[function(a,b,c){var d,e,f,g,h,i;d=a("jquery"),g=a("../modules/logging/assert"),i=a("../modules/logging/log"),f=a("../modules/semaphore"),h=a("../configuration/config"),b.exports=e=function(){function a(a){var b,c;this.componentTree=a.componentTree,this.renderingContainer=a.renderingContainer,b=a.$wrapper,c=a.excludeComponents,g(this.componentTree,"no componentTree specified"),g(this.renderingContainer,"no rendering container specified"),this.$root=d(this.renderingContainer.renderNode),this.$wrapperHtml=b,this.componentViews={},this.excludedComponentIds={},this.excludeComponent(c),this.readySemaphore=new f,this.renderOncePageReady(),this.readySemaphore.start()}return a.prototype.excludeComponent=function(a){var b,c,e,f,g;if(null!=a){if(d.isArray(a)){for(f=[],c=0,e=a.length;e>c;c++)b=a[c],f.push(this.excludeComponent(b));return f}return this.excludedComponentIds[a]=!0,g=this.componentViews[a],null!=g&&g.isAttachedToDom?this.removeComponentFromDom(g.model):void 0}},a.prototype.setRoot=function(){var a,b,c;return(null!=(b=this.$wrapperHtml)?b.length:void 0)&&this.$wrapperHtml.jquery&&(c="."+h.css.section,a=this.$wrapperHtml.find(c).add(this.$wrapperHtml.filter(c)),a.length&&(this.$wrapper=this.$root,this.$wrapper.append(this.$wrapperHtml),this.$root=a)),this.$root.data("componentTree",this.componentTree)},a.prototype.renderOncePageReady=function(){return this.readySemaphore.increment(),this.renderingContainer.ready(function(a){return function(){return a.setRoot(),a.render(),a.setupComponentTreeListeners(),a.readySemaphore.decrement()}}(this))},a.prototype.ready=function(a){return this.readySemaphore.addCallback(a)},a.prototype.isReady=function(){return this.readySemaphore.isReady()},a.prototype.html=function(){return g(this.isReady(),"Cannot generate html. Renderer is not ready."),this.renderingContainer.html()},a.prototype.setupComponentTreeListeners=function(){return this.componentTree.componentAdded.add(d.proxy(this.componentAdded,this)),this.componentTree.componentRemoved.add(d.proxy(this.componentRemoved,this)),this.componentTree.componentMoved.add(d.proxy(this.componentMoved,this)),this.componentTree.componentContentChanged.add(d.proxy(this.componentContentChanged,this)),this.componentTree.componentHtmlChanged.add(d.proxy(this.componentHtmlChanged,this))},a.prototype.componentAdded=function(a){return this.insertComponent(a)},a.prototype.componentRemoved=function(a){return a.descendantsAndSelf(function(a){return function(b){return a.removeComponentFromDom(b),a.deleteCachedComponentView(b)}}(this))},a.prototype.componentMoved=function(a){return this.removeComponentFromDom(a),this.insertComponent(a)},a.prototype.componentContentChanged=function(a,b){return this.getOrCreateComponentView(a).updateContent(b)},a.prototype.componentHtmlChanged=function(a){return this.getOrCreateComponentView(a).updateHtml()},a.prototype.getComponentViewById=function(a){return this.componentViews[a]},a.prototype.getOrCreateComponentView=function(a){var b;return(b=this.componentViews[a.id])?b:(b=a.createView(this.renderingContainer.isReadOnly),b.setRenderer(this),this.componentViews[a.id]=b)},a.prototype.deleteCachedComponentView=function(a){var b;return null!=(b=this.componentViews[a.id])&&b.removeRenderer(),delete this.componentViews[a.id]},a.prototype.render=function(){return this.componentTree.each(function(a){return function(b){return a.insertComponent(b)}}(this))},a.prototype.clear=function(){return this.componentTree.each(function(a){return function(b){return a.getOrCreateComponentView(b).setAttachedToDom(!1)}}(this)),this.$root.empty()},a.prototype.redraw=function(){return this.clear(),this.render()},a.prototype.refreshComponent=function(a){var b;return b=this.getComponentViewById(a.id),b.descendantsAndSelf(function(a){return function(b){return a.removeComponentFromDom(b.model),b.recreateHtml()}}(this)),this.insertComponent(a),this.renderingContainer.componentViewWasRefreshed.fire(b)},a.prototype.insertComponent=function(a){var b;if(!this.isComponentAttached(a)&&this.excludedComponentIds[a.id]!==!0)return this.isComponentAttached(a.previous)?this.insertComponentAsSibling(a.previous,a):this.isComponentAttached(a.next)?this.insertComponentAsSibling(a.next,a):a.parentContainer?this.appendComponentToParentContainer(a):i.error("Component could not be inserted by renderer."),b=this.getOrCreateComponentView(a),b.setAttachedToDom(!0),this.renderingContainer.componentViewWasInserted(b),this.attachChildComponents(a)},a.prototype.isComponentAttached=function(a){var b;return a&&(null!=(b=this.getComponentViewById(a.id))?b.isAttachedToDom:void 0)},a.prototype.attachChildComponents=function(a){return a.children(function(a){return function(b){return a.isComponentAttached(b)?void 0:a.insertComponent(b)}}(this))},a.prototype.insertComponentAsSibling=function(a,b){var c;return c=a===b.previous?"after":"before",this.$nodeForComponent(a)[c](this.$nodeForComponent(b))},a.prototype.appendComponentToParentContainer=function(a){var b,c;return c=this.$nodeForComponent(a),b=this.$nodeForContainer(a.parentContainer),b.append(c)},a.prototype.$nodeForComponent=function(a){return this.getOrCreateComponentView(a).$html},a.prototype.$nodeForContainer=function(a){var b;return a.isRoot?this.$root:(b=this.getOrCreateComponentView(a.parentComponent),d(b.getDirectiveElement(a.name)))},a.prototype.removeComponentFromDom=function(a){var b;return this.isComponentAttached(a)?(b=this.getComponentViewById(a.id),b.$html.detach(),b.setAttachedToDom(!1)):void 0},a}()},{"../configuration/config":26,"../modules/logging/assert":49,"../modules/logging/log":50,"../modules/semaphore":52,jquery:"jquery"}],60:[function(a,b,c){var d,e,f,g;f=a("./renderer"),e=a("../rendering_container/page"),d=a("../rendering_container/interactive_page"),b.exports=g=function(){function a(a){var b;this.livingdoc=a.livingdoc,b=a.parent,this.isInteractive=a.isInteractive,this.wrapper=a.wrapper,this.loadResources=a.loadResources,this.parent=(null!=b?b.jquery:void 0)?b[0]:b,null==this.parent&&(this.parent=window.document.body),null==this.isInteractive&&(this.isInteractive=!1),this.isReady=!1,this.whenReadyDeferred=$.Deferred(),this.whenReady=this.whenReadyDeferred.promise()}return a.prototype.create=function(a){
var b;return b=(null!=a?a:{}).renderInIframe,b?this.createIFrame(this.parent,function(a){return function(){return a.addBaseTarget(),a.createIFrameRenderer(),a.isReady=!0,a.whenReadyDeferred.resolve({iframe:a.iframe,renderer:a.renderer})}}(this)):(this.createRenderer({renderNode:this.parent}),this.isReady=!0,this.whenReadyDeferred.resolve({renderer:this.renderer})),this.whenReady},a.prototype.addBaseTarget=function(){var a,b;return b=this.iframe.contentDocument,a=b.createElement("base"),a.setAttribute("target","_blank"),b.getElementsByTagName("head")[0].appendChild(a)},a.prototype.createIFrame=function(a,b){var c;return c=a.ownerDocument.createElement("iframe"),c.src="about:blank",c.setAttribute("frameBorder","0"),this.iframe=c,c.onload=function(){return b(c)},a.appendChild(c)},a.prototype.createIFrameRenderer=function(){return this.createRenderer({renderNode:this.iframe.contentDocument.body})},a.prototype.createRenderer=function(a){var b,c;return c=(null!=a?a:{}).renderNode,b={renderNode:c||this.parent,documentDependencies:this.livingdoc.dependencies,design:this.livingdoc.design,loadResources:this.loadResources},this.page=this.isInteractive?new d(b):new e(b),this.renderer=new f({renderingContainer:this.page,componentTree:this.livingdoc.componentTree,$wrapper:$(this.wrapper)})},a}()},{"../rendering_container/interactive_page":64,"../rendering_container/page":66,"./renderer":59}],61:[function(a,b,c){var d,e,f,g,h;d=a("jquery"),g=a("./js_loader"),f=a("./css_loader"),h=a("../modules/semaphore"),b.exports=e=function(){function a(a){var b;this.window=a.window,b=a.disable,this.isDisabled=b||!1,this.cssLoader=new f(this.window),this.jsLoader=new g(this.window)}return a.prototype.loadDependencies=function(a,b,c){var d,e,f,g,i;for(i=new h,i.addCallback(c),this.loadSequentially(a,i),g=b||[],e=0,f=g.length;f>e;e++)d=g[e],this.loadCss(d,i.wait());return i.start()},a.prototype.loadSequentially=function(a,b){var c,d;return(null!=a?a.length:void 0)?(b.increment(a.length),c=0,(d=function(e){return function(){return e.loadJs(a[c],function(){return b.decrement(),c+=1,c<a.length?d():void 0})}}(this))()):void 0},a.prototype.loadDependency=function(a,b){return a.isJs()?this.loadJs(a,b):a.isCss()?this.loadCss(a,b):void 0},a.prototype.loadJs=function(a,b){var c;return this.isDisabled?b():a.inline?(c=!a.isExecuteOnly,this.jsLoader.loadInlineScript(a.code,c,b)):this.jsLoader.loadSingleUrl(a.src,b)},a.prototype.loadCss=function(a,b){return this.isDisabled?b():a.inline?this.cssLoader.loadInlineStyles(a.code,b):this.cssLoader.loadSingleUrl(a.src,b)},a}()},{"../modules/semaphore":52,"./css_loader":62,"./js_loader":65,jquery:"jquery"}],62:[function(a,b,c){var d,e;d=a("jquery"),b.exports=e=function(){function a(a){this.window=a,this.loadedUrls=[],this.loadedInlineStyles=[]}return a.prototype.loadSingleUrl=function(a,b){var c;return null==b&&(b=function(){}),this.isUrlLoaded(a)?b():(c=d('<link rel="stylesheet" type="text/css" />')[0],c.onload=b,c.onerror=function(){return console.warn("Stylesheet could not be loaded: "+a),b()},c.href=a,this.window.document.head.appendChild(c),this.loadedUrls.push(a))},a.prototype.isUrlLoaded=function(a){return this.loadedUrls.indexOf(a)>=0},a.prototype.loadInlineStyles=function(a,b){var c,d;return null==b&&(b=function(){}),a=this.prepareInlineStyles(a),this.areInlineStylesLoaded(a)?b():(c=this.window.document,d=c.createElement("style"),d.innerHTML=a,c.body.appendChild(d),this.loadedInlineStyles.push(a),b())},a.prototype.prepareInlineStyles=function(a){return a.replace(/<style[^>]*>|<\/style>/gi,"")},a.prototype.areInlineStylesLoaded=function(a){return this.loadedInlineStyles.indexOf(a)>=0},a}()},{jquery:"jquery"}],63:[function(a,b,c){var d,e,f,g,h;g=a("../configuration/config"),h=g.css,e=a("../interaction/drag_base"),d=a("../interaction/component_drag"),b.exports=f=function(){function a(){this.setWindow(),this.dragBase=new e(this),this.editableController={disableAll:function(){},reenableAll:function(){}},this.componentWasDropped={fire:function(){}},this.blurFocusedElement=function(){}}return a.prototype.startDrag=function(a){var b,c,e,f,g;return c=a.componentModel,e=a.componentView,g=a.event,f=a.config,c||e?(e&&(c=e.model),b=new d({componentModel:c,componentView:e}),null==f&&(f={longpress:{showIndicator:!0,delay:400,tolerance:3}}),this.dragBase.init(b,g,f)):void 0},a.prototype.setWindow=function(){return this.window=window,this.document=this.window.document,this.$document=$(this.document),this.$body=$(this.document.body)},a}()},{"../configuration/config":26,"../interaction/component_drag":38,"../interaction/drag_base":41}],64:[function(a,b,c){var d,e,f,g,h,i,j,k,l=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},m={}.hasOwnProperty;j=a("../configuration/config"),i=a("./page"),k=a("../interaction/dom"),g=a("../interaction/focus"),f=a("../interaction/editable_controller"),e=a("../interaction/drag_base"),d=a("../interaction/component_drag"),b.exports=h=function(a){function b(a){var c,d,h;d=null!=a?a:{},h=d.renderNode,c=d.hostWindow,b.__super__.constructor.apply(this,arguments),this.focus=new g,this.editableController=new f(this),this.imageClick=$.Callbacks(),this.htmlElementClick=$.Callbacks(),this.linkClick=$.Callbacks(),this.componentWillBeDragged=$.Callbacks(),this.componentWasDropped=$.Callbacks(),this.dragBase=new e(this),this.focus.componentFocus.add($.proxy(this.afterComponentFocused,this)),this.focus.componentBlur.add($.proxy(this.afterComponentBlurred,this)),this.beforeInteractivePageReady(),this.$document.on("mousedown.livingdocs",$.proxy(this.mousedown,this)).on("click.livingdocs",$.proxy(this.click,this)).on("touchstart.livingdocs",$.proxy(this.mousedown,this)).on("dragstart.livingdocs",$.proxy(this.browserDragStart,this))}var c;return l(b,a),c=1,b.prototype.isReadOnly=!1,b.prototype.beforeInteractivePageReady=function(){return j.livingdocsCssFile&&this.loadResources?this.assets.cssLoader.loadSingleUrl(j.livingdocsCssFile,this.readySemaphore.wait()):void 0},b.prototype.browserDragStart=function(a){return a.preventDefault(),a.stopPropagation()},b.prototype.removeListeners=function(){return this.$document.off(".livingdocs"),this.$document.off(".livingdocs-drag")},b.prototype.mousedown=function(a){var b,d;if((a.which===c||"mousedown"!==a.type)&&(d=$(a.target).closest(j.ignoreInteraction).length,!d))return b=k.findComponentView(a.target),this.handleClickedComponent(a,b),b?this.startDrag({componentView:b,event:a}):void 0},b.prototype.click=function(a){var b;return b=a.target,k.isInsideDocLink(b)?a.preventDefault():void 0},b.prototype.startDrag=function(a){var b,c,e,f,g;return c=a.componentModel,e=a.componentView,g=a.event,f=a.config,c||e?(e&&(c=e.model),b=new d({componentModel:c,componentView:e}),null==f&&(f={longpress:{showIndicator:!0,delay:400,tolerance:3}}),this.dragBase.init(b,g,f)):void 0},b.prototype.cancelDrag=function(){return this.dragBase.cancel()},b.prototype.handleClickedComponent=function(a,b){var c;if(!b)return this.focus.blur();if(this.focus.componentFocused(b),c=k.getDirectiveContext(a.target),null!=c){if(c.image)return this.imageClick.fire(b,c.image.name,a);if(c.link)return this.linkClick.fire(b,c.link.name,a);if(c.html)return this.htmlElementClick.fire(b,c.html.name,a)}},b.prototype.getFocusedElement=function(){return this.window.document.activeElement},b.prototype.blurFocusedElement=function(){var a;return this.focus.setFocus(void 0),a=this.getFocusedElement(),a?$(a).blur():void 0},b.prototype.componentViewWasInserted=function(a){return this.initializeEditables(a)},b.prototype.initializeEditables=function(a){var b,c;return a.directives.editable?(c=function(){var c,d,e,f;for(e=a.directives.editable,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(b.elem);return f}(),this.editableController.add(c)):void 0},b.prototype.afterComponentFocused=function(a){return a.afterFocused()},b.prototype.afterComponentBlurred=function(a){return a.afterBlurred()},b}(i)},{"../configuration/config":26,"../interaction/component_drag":38,"../interaction/dom":40,"../interaction/drag_base":41,"../interaction/editable_controller":42,"../interaction/focus":43,"./page":66}],65:[function(a,b,c){var d;b.exports=d=function(){function a(a){this.window=a,this.loadedUrls=[],this.loadedScripts=[]}return a.prototype.loadSingleUrl=function(a,b){var c,d,e,f,g,h;return null==b&&(b=function(){}),this.isUrlLoaded(a)?b():(c=this.window.document,h="readyState",g="onreadystatechange",e=c.getElementsByTagName("head")[0],d=c.createElement("script"),f=void 0,d.onload=d.onerror=d[g]=function(c){return function(){return d[h]&&!/^c|loade/.test(d[h])||f?void 0:(d.onload=d[g]=null,f=!0,c.loadedUrls.push(a),b())}}(this),d.async=!0,d.src=a,e.insertBefore(d,e.lastChild))},a.prototype.isUrlLoaded=function(a){return this.loadedUrls.indexOf(a)>=0},a.prototype.loadInlineScript=function(a,b,c){var d,e;return null==c&&(c=function(){}),a=this.prepareInlineCode(a),this.isInlineBlockLoaded(a)?c():(d=this.window.document,e=d.createElement("script"),e.innerHTML=a,d.body.appendChild(e),b&&this.loadedScripts.push(a),c())},a.prototype.prepareInlineCode=function(a){return a.replace(/<script[^>]*>|<\/script>/gi,"")},a.prototype.isInlineBlockLoaded=function(a){return this.loadedScripts.indexOf(a)>=0},a}()},{}],66:[function(a,b,c){var d,e,f,g,h,i=function(a,b){return function(){return a.apply(b,arguments)}},j=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},k={}.hasOwnProperty;d=a("jquery"),g=a("./rendering_container"),e=a("./assets"),h=a("../configuration/config"),b.exports=f=function(a){function b(a){var c,f,g,j,k;j=null!=a?a:{},k=j.renderNode,g=j.readOnly,c=j.hostWindow,this.documentDependencies=j.documentDependencies,this.design=j.design,this.componentTree=j.componentTree,this.loadResources=j.loadResources,this.loadAssets=i(this.loadAssets,this),null==this.loadResources&&(this.loadResources=h.loadResources),null!=g&&(this.isReadOnly=g),this.renderNode=(null!=k?k.jquery:void 0)?k[0]:k,this.setWindow(c),null==this.renderNode&&(this.renderNode=d("."+h.css.section,this.$body)),this.componentViewWasRefreshed=d.Callbacks(),b.__super__.constructor.call(this),f=!this.loadResources,this.assets=new e({window:this.window,disable:f}),this.loadAssets()}return j(b,a),b.prototype.beforeReady=function(){return this.readySemaphore.wait(),setTimeout(function(a){return function(){return a.readySemaphore.decrement()}}(this),0)},b.prototype.loadAssets=function(){var a;return null!=this.design&&(a=this.design.dependencies,this.assets.loadDependencies(a.js,a.css,this.readySemaphore.wait())),null!=this.documentDependencies?(a=this.documentDependencies,this.assets.loadDependencies(a.js,a.css,this.readySemaphore.wait()),this.documentDependencies.dependenciesAdded.add(function(a){return function(b,c){return a.assets.loadDependencies(b,c,function(){})}}(this)),this.documentDependencies.dependencyToExecute.add(function(a){return function(b){return a.assets.loadDependency(b)}}(this)),this.documentDependencies.codeToExecute.add(function(a){return function(b){return b(a.window)}}(this))):void 0},b.prototype.setWindow=function(a){return null==a&&(a=this.getParentWindow(this.renderNode)),this.window=a,this.document=this.window.document,this.$document=d(this.document),this.$body=d(this.document.body)},b.prototype.getParentWindow=function(a){return null!=a?a.ownerDocument.defaultView:window},b}(g)},{"../configuration/config":26,"./assets":61,"./rendering_container":67,jquery:"jquery"}],67:[function(a,b,c){var d,e,f;d=a("jquery"),f=a("../modules/semaphore"),b.exports=e=function(){function a(){null==this.renderNode&&(this.renderNode=d("<div>")[0]),this.readySemaphore=new f,this.beforeReady(),this.readySemaphore.start()}return a.prototype.isReadOnly=!0,a.prototype.html=function(){return d(this.renderNode).html()},a.prototype.componentViewWasInserted=function(a){},a.prototype.beforeReady=function(){},a.prototype.ready=function(a){return this.readySemaphore.addCallback(a)},a}()},{"../modules/semaphore":52,jquery:"jquery"}],68:[function(a,b,c){var d,e,f,g,h;d=a("jquery"),h=a("../configuration/config"),g=a("../interaction/dom"),f=a("../modules/logging/assert"),b.exports=e=function(){function a(a){var b;this.name=a.name,this.type=a.type,this.elem=a.elem,b=a.config,"optional"!==this.type&&f(this.name,"TemplateDirective: name is missing from "+this.type+" directive"),this.config=Object.create(h.directives[this.type]),this.setConfig(b),this.optional=!1}return a.prototype.setConfig=function(a){return d.extend(this.config,a)},a.prototype.renderedAttr=function(){return this.config.renderedAttr},a.prototype.overwritesContent=function(){return!!this.config.overwritesContent},a.prototype.isModification=function(){return null!=this.config.modifies},a.prototype.getTagName=function(){return this.elem.nodeName.toLowerCase()},a.prototype.clone=function(){var b;return b=new a({name:this.name,type:this.type,config:this.config}),b.optional=this.optional,b},a.prototype.getAbsoluteBoundingClientRect=function(){return g.getAbsoluteBoundingClientRect(this.elem)},a.prototype.getBoundingClientRect=function(){return this.elem.getBoundingClientRect()},a}()},{"../configuration/config":26,"../interaction/dom":40,"../modules/logging/assert":49,jquery:"jquery"}],69:[function(a,b,c){var d,e,f,g,h;d=a("jquery"),g=a("../modules/logging/assert"),h=a("../configuration/config"),e=a("./directive"),b.exports=f=function(){function a(a){this.all=null!=a?a:{},this.length=0}return a.prototype.add=function(a){var b;return this.assertNameNotUsed(a),this[this.length]=a,a.index=this.length,this.length+=1,this.all[a.name]=a,this[b=a.type]||(this[b]=[]),this[a.type].push(a),a},a.prototype.next=function(a){var b;return a instanceof e&&(b=a),null==b&&(b=this.all[a]),this[b.index+=1]},a.prototype.nextOfType=function(a){var b,c;for(a instanceof e&&(b=a),null==b&&(b=this.all[a]),c=b.type;b=this.next(b);)if(b.type===c)return b},a.prototype.get=function(a){return this.all[a]},a.prototype.count=function(a){var b;return a?null!=(b=this[a])?b.length:void 0:this.length},a.prototype.names=function(a){var b,c,d,e,f,g;if(!(null!=(e=this[a])?e.length:void 0))return[];for(f=this[a],g=[],c=0,d=f.length;d>c;c++)b=f[c],g.push(b.name);return g},a.prototype.each=function(a){var b,c,d,e;for(e=[],c=0,d=this.length;d>c;c++)b=this[c],e.push(a(b));return e},a.prototype.eachOfType=function(a,b){var c,d,e,f,g;if(this[a]){for(f=this[a],g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(b(c));return g}},a.prototype.firstOfType=function(a){var b;return null!=(b=this[a])?b[0]:void 0},a.prototype.eachEditable=function(a){return this.eachOfType("editable",a)},a.prototype.eachImage=function(a){return this.eachOfType("image",a)},a.prototype.eachContainer=function(a){return this.eachOfType("container",a)},a.prototype.eachHtml=function(a){return this.eachOfType("html",a)},a.prototype.clone=function(){var b;return b=new a,this.each(function(a){return b.add(a.clone())}),b},a.prototype.$getElem=function(a){return d(this.all[a].elem)},a.prototype.assertAllLinked=function(){return this.each(function(a){return a.elem?void 0:!1}),!0},a.prototype.assertNameNotUsed=function(a){return g(a&&!this.all[a.name],a.type+" Template parsing error:\n"+h.directives[a.type].renderedAttr+'="'+a.name+'".\n"'+a.name+'" is a duplicate name.')},a}()},{"../configuration/config":26,"../modules/logging/assert":49,"./directive":68,jquery:"jquery"}],70:[function(a,b,c){var d,e,f,g,h;g=a("../configuration/config"),d=a("./directive"),h=a("./directive_finder"),f=a("../modules/logging/assert"),e=a("underscore"),b.exports=function(){return{parse:function(a){var b,c,d;return b=[],c=[],d=!1,this.eachDirective(a,function(a){return a.isModification()?c.push(a):(a.overwritesContent()&&(f(!d,"Incompatible directives declared on element ("+a.type+" directive '"+a.name+"')"),d=!0),b.push(a))}),b.length&&this.applyModifications(b,c),b},eachDirective:function(a,b){var c,e,f,g,i,j;for(f=[],h.eachDirective(a,function(b){return function(b,c,e){return f.push({attributeName:e,directive:new d({name:c,type:b,elem:a})})}}(this)),j=[],g=0,i=f.length;i>g;g++)c=f[g],e=c.directive,this.rewriteAttribute(e,c.attributeName),j.push(b(e));return j},applyModifications:function(a,b){var c,d,f,g,h;for(h=[],d=0,f=b.length;f>d;d++)g=b[d],h.push("optional"===g.type?function(){var b,d,f;for(f=[],b=0,d=a.length;d>b;b++)c=a[b],f.push(e.contains(g.config.modifies,c.type)?c.optional=!0:void 0);return f}():void 0);return h},rewriteAttribute:function(a,b){return a.isModification()?this.removeAttribute(a,b):b!==a.renderedAttr()?this.normalizeAttribute(a,b):a.name?void 0:this.normalizeAttribute(a)},normalizeAttribute:function(a,b){var c;return c=a.elem,b&&this.removeAttribute(a,b),c.setAttribute(a.renderedAttr(),a.name)},removeAttribute:function(a,b){return a.elem.removeAttribute(b)}}}()},{"../configuration/config":26,"../modules/logging/assert":49,"./directive":68,"./directive_finder":71,underscore:10}],71:[function(a,b,c){var d,e;d=a("../configuration/config"),b.exports=e=function(){var a;return a=/^(x-|data-)/,{link:function(a,b){return this.eachDirective(a,function(c,d){var e;return e=b.get(d),e.elem=a})},eachDirective:function(b,c){var e,f,g,h,i,j,k;for(j=b.attributes,g=0,h=j.length;h>g;g++)e=j[g],f=e.name,i=f.replace(a,""),(k=d.templateAttrLookup[i])&&c(k,e.value,f);return void 0}}}()},{"../configuration/config":26}],72:[function(a,b,c){var d,e,f;e=a("../configuration/config"),f=a("./directive_finder"),b.exports=d=function(){function a(a){this.root=this._next=a}return a.prototype.current=null,a.prototype.next=function(){var a,b,c;if(b=this.current=this._next,a=c=void 0,this.current)if(a=b.firstChild,a&&1===b.nodeType&&!this.skipChildren(b))this._next=a;else{for(c=null;b!==this.root&&!(c=b.nextSibling);)b=b.parentNode;this._next=c}return this.current},a.prototype.skipChildren=function(a){var b;return b=!1,f.eachDirective(a,function(a,c){return e.directives[a].overwritesContent?b=!0:void 0}),b},a.prototype.nextElement=function(){for(var a;this.next()&&(a=!1,1!==this.current.nodeType););return this.current},a.prototype.detach=function(){return this.current=this.root=null},a}()},{"../configuration/config":26,"./directive_finder":71}],73:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;d=a("jquery"),n=a("../modules/logging/log"),j=a("../modules/logging/assert"),p=a("../modules/words"),k=a("../configuration/config"),h=a("./directive_iterator"),g=a("./directive_collection"),l=a("./directive_compiler"),m=a("./directive_finder"),e=a("../component_tree/component_model"),f=a("../rendering/component_view"),o=function(a,b){return a.name>b.name?1:a.name<b.name?-1:0},b.exports=i=function(){function a(a){var b,c,e,f;f=null!=a?a:{},this.name=f.name,b=f.html,c=f.label,e=f.properties,this.allowedParents=f.allowedParents,j(b,"Template: param html missing"),this.$template=d(this.pruneHtml(b)).wrap("<div>"),this.$wrap=this.$template.parent(),this.label=c||p.humanize(this.name),this.styles=e||{},this.defaults={},this.parseTemplate()}return a.prototype.setDesign=function(a){return this.design=a,this.identifier=a.name+"."+this.name},a.prototype.createModel=function(){return new e({template:this})},a.prototype.createView=function(a,b){var c,d,e,g;return g=this.createViewHtml(),c=g.$elem,e=g.directives,a||(a=this.createModel()),d=new f({model:a,$html:c,directives:e,isReadOnly:b})},a.prototype.createViewHtml=function(){var a,b;return a=this.$template.clone(),b=this.linkDirectives(a[0]),{$elem:a,directives:b}},a.prototype.pruneHtml=function(a){return a=d(a).filter(function(a){return 8!==this.nodeType}),j(1===a.length,'Templates must contain one root element. The Template "'+this.identifier+'" contains '+a.length),a},a.prototype.parseTemplate=function(){var a;return a=this.$template[0],this.directives=this.compileDirectives(a),this.directives.each(function(a){return function(b){switch(b.type){case"editable":return a.formatEditable(b.name,b.elem);case"container":return a.formatContainer(b.name,b.elem);case"html":return a.formatHtml(b.name,b.elem)}}}(this))},a.prototype.compileDirectives=function(a){var b,c,d,e,f,i;for(f=new h(a),c=new g;a=f.nextElement();)for(d=l.parse(a),e=0,i=d.length;i>e;e++)b=d[e],c.add(b);return c},a.prototype.linkDirectives=function(a){var b,c;for(c=new h(a),b=this.directives.clone();a=c.nextElement();)m.link(a,b);return b},a.prototype.formatEditable=function(a,b){var c,e;return c=d(b),c.addClass(k.css.editable),e=p.trim(b.innerHTML),this.defaults[a]=e?e:"",b.innerHTML=""},a.prototype.formatContainer=function(a,b){return b.innerHTML=""},a.prototype.formatHtml=function(a,b){var c;return c=p.trim(b.innerHTML),c&&(this.defaults[a]=c),b.innerHTML=""},a.prototype.info=function(){var a,b,c,d,e;a={name:this.name,design:null!=(c=this.design)?c.name:void 0,directives:[],properties:[]},this.directives.each(function(b){return function(b){var c,d;return c=b.name,d=b.type,a.directives.push({name:c,type:d})}}(this)),d=this.styles;for(b in d)e=d[b],a.properties.push({name:b,type:"cssModificator"});return a.directives.sort(o),a.properties.sort(o),a},a}(),i.parseIdentifier=function(a){var b;if(a)return b=a.split("."),1===b.length?{designName:void 0,name:b[0]}:2===b.length?{designName:b[0],name:b[1]}:n.error("could not parse component template identifier: "+a)}},{"../component_tree/component_model":17,"../configuration/config":26,"../modules/logging/assert":49,"../modules/logging/log":50,"../modules/words":54,"../rendering/component_view":55,"./directive_collection":69,"./directive_compiler":70,"./directive_finder":71,"./directive_iterator":72,jquery:"jquery"}],74:[function(a,b,c){b.exports={version:"0.10.3",revision:"b927237"}},{}],jquery:[function(a,b,c){b.exports=$},{}]},{},[12]);